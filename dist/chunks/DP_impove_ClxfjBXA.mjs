import { c as createComponent, m as maybeRenderHead, u as unescapeHTML, r as renderTemplate } from './astro/server_BWQ42mf1.mjs';
import 'kleur/colors';
import 'clsx';

const html = () => "<hr>\n<section><h1 id=\"树形dp\">树形DP<a class=\"anchor\" href=\"#树形dp\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h1><p>树形 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>DP</mtext></mrow><annotation encoding=\"application/x-tex\">\\text{DP}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord text\"><span class=\"mord\">DP</span></span></span></span></span>，即在树上进行的 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>DP</mtext></mrow><annotation encoding=\"application/x-tex\">\\text{DP}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord text\"><span class=\"mord\">DP</span></span></span></span></span>。\n由于遍历树固有的递归性质，树形 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>DP</mtext></mrow><annotation encoding=\"application/x-tex\">\\text{DP}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord text\"><span class=\"mord\">DP</span></span></span></span></span> 一般都是递归进行的。我们将从一些经典模型和例子开始。</p><section><h2 id=\"求所有点的子树大小\">求所有点的子树大小<a class=\"anchor\" href=\"#求所有点的子树大小\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h2><div class=\"expressive-code\"><link rel=\"stylesheet\" href=\"/_astro/ec.d1dr8.css\"><script type=\"module\" src=\"/_astro/ec.qopfj.js\"></script><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"cpp\" class=\"wrap\" style=\"--ecMaxLine:41ch\"><code><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">1</div></div><div class=\"code\"><span style=\"--0:#F97583;--1:#F97583\">inline</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">void</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#B392F0;--1:#B392F0\">dfs</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#F97583;--1:#F97583\">const</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#FFAB70;--1:#FFAB70\">u</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,</span><span style=\"--0:#F97583;--1:#F97583\">const</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#FFAB70;--1:#FFAB70\">f</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">){</span></div></div><div class=\"ec-line\" style=\"--ecIndent:2ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">2</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">  </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">siz[u]</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;</span></div></div><div class=\"ec-line\" style=\"--ecIndent:2ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">3</div></div><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#F97583;--1:#F97583\">for</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> i</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">head[u];i;i</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">edge[i].next){</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">4</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> v</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">edge[i].to;</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">5</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#F97583;--1:#F97583\">if</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(f</span><span style=\"--0:#F97583;--1:#F97583\">!=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">v) </span><span style=\"--0:#B392F0;--1:#B392F0\">dfs</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(v,u);</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">6</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">    </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">siz[u]</span><span style=\"--0:#F97583;--1:#F97583\">+=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">siz[v];</span></div></div><div class=\"ec-line\" style=\"--ecIndent:2ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">7</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">  </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">}</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">8</div></div><div class=\"code\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">}</span></div></div></code><button class=\"copy-btn\" aria-label=\"Copy code\"><div class=\"copy-btn-icon\"><svg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon copy-icon\"><path d=\"M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z\"></path></svg><svg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon success-icon\"><path d=\"m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z\"></path></svg></div></button></pre></figure></div></section><section><h2 id=\"树上最大独立集\">树上最大独立集<a class=\"anchor\" href=\"#树上最大独立集\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h2><p>给出⼀个 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span> 个点的树，每个点有权值 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>w</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">w_{i}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>，要求选出⼀个点集权值和最大。使得没有⼀条边两端的点同时被选。\n要求时间复杂度 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>n</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(n)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">)</span></span></span></span>。</p><p>常见的树形 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>DP</mtext></mrow><annotation encoding=\"application/x-tex\">\\text{DP}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord text\"><span class=\"mord\">DP</span></span></span></span></span> 都会记录 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>f</mi><mrow><mi>u</mi><mo separator=\"true\">,</mo><mn>0</mn><mi mathvariant=\"normal\">/</mi><mn>1</mn></mrow></msub></mrow><annotation encoding=\"application/x-tex\">f_{u,0/1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0496em;vertical-align:-0.3552em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.5198em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">u</span><span class=\"mpunct mtight\">,</span><span class=\"mord mtight\">0/1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3552em;\"><span></span></span></span></span></span></span></span></span></span> 答案（视情况分析）。\n在这个题里，可以这样设计状态 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>f</mi><mrow><mi>u</mi><mo separator=\"true\">,</mo><mn>0</mn><mi mathvariant=\"normal\">/</mi><mn>1</mn></mrow></msub></mrow><annotation encoding=\"application/x-tex\">f_{u,0/1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0496em;vertical-align:-0.3552em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.5198em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">u</span><span class=\"mpunct mtight\">,</span><span class=\"mord mtight\">0/1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3552em;\"><span></span></span></span></span></span></span></span></span></span> 分别表⽰<strong>不选</strong>和<strong>选了</strong>的情况下的答案。\n因为树天生具有⼀种无后效性，想要合并儿子的信息只需要儿子那⼀个点的信息。\n也就是子树内做完 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>DP</mtext></mrow><annotation encoding=\"application/x-tex\">\\text{DP}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord text\"><span class=\"mord\">DP</span></span></span></span></span> 之后，只需要保留根的信息就好了，同时采用 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>dfs</mtext></mrow><annotation encoding=\"application/x-tex\">\\text{dfs}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord text\"><span class=\"mord\">dfs</span></span></span></span></span> 的方法来 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>DP</mtext></mrow><annotation encoding=\"application/x-tex\">\\text{DP}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord text\"><span class=\"mord\">DP</span></span></span></span></span>。</p><div class=\"expressive-code\"><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"cpp\" class=\"wrap\" style=\"--ecMaxLine:56ch\"><code><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">1</div></div><div class=\"code\"><span style=\"--0:#F97583;--1:#F97583\">inline</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">void</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#B392F0;--1:#B392F0\">dfs</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#F97583;--1:#F97583\">const</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#FFAB70;--1:#FFAB70\">u</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,</span><span style=\"--0:#F97583;--1:#F97583\">const</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#FFAB70;--1:#FFAB70\">f</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">){</span></div></div><div class=\"ec-line\" style=\"--ecIndent:2ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">2</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">  </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">f[u][</span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">]</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,f[u][</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">]</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">w[u];</span></div></div><div class=\"ec-line\" style=\"--ecIndent:2ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">3</div></div><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#F97583;--1:#F97583\">for</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> i</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">head[u];i;i</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">edge[i].next){</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">4</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> v</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">edge[i].to;</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">5</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#F97583;--1:#F97583\">if</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(f</span><span style=\"--0:#F97583;--1:#F97583\">!=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">v) </span><span style=\"--0:#B392F0;--1:#B392F0\">dfs</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(v,u);</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">6</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">    </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">f[u][</span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">]</span><span style=\"--0:#F97583;--1:#F97583\">+=</span><span style=\"--0:#B392F0;--1:#B392F0\">max</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(f[v][</span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">],f[v][</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">]);</span><span style=\"--0:#99A0A6;--1:#99A0A6\"> // 若u不选，则⼉⼦可选可不选，取⼤者。</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">7</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">    </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">f[u][</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">]</span><span style=\"--0:#F97583;--1:#F97583\">+=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">f[v][</span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">];</span><span style=\"--0:#99A0A6;--1:#99A0A6\">// 若u选上，则⼉⼦只能不选。</span></div></div><div class=\"ec-line\" style=\"--ecIndent:2ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">8</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">  </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">}</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">9</div></div><div class=\"code\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">}</span></div></div></code><button class=\"copy-btn\" aria-label=\"Copy code\"><div class=\"copy-btn-icon\"><svg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon copy-icon\"><path d=\"M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z\"></path></svg><svg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon success-icon\"><path d=\"m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z\"></path></svg></div></button></pre></figure></div></section><section><h2 id=\"树上背包\">树上背包<a class=\"anchor\" href=\"#树上背包\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h2><p>树上的背包问题，简单来说就是背包问题与树形 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>DP</mtext></mrow><annotation encoding=\"application/x-tex\">\\text{DP}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord text\"><span class=\"mord\">DP</span></span></span></span></span> 的结合。\n在此之前需要了解基本的<strong>背包模型</strong>和<strong>背包的合并</strong>。</p><blockquote>\n<p>Attention:\n树上背包问题代码时间复杂度是 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(n^{2})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">n</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span> 的。</p>\n</blockquote><section><h3 id=\"例题p2014-ctsc1997-选课\">例题：<a href=\"https://www.luogu.com.cn/problem/P2014\">P2014 [CTSC1997] 选课</a><a class=\"anchor\" href=\"#例题p2014-ctsc1997-选课\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h3><p>给出 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span> 个点的森林，每个点有权值 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>a</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">a_{i}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>，要求选了⼀个点必然要选其父亲。求出选择 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">m</span></span></span></span> 个点能得到的最⼤权值和。\n数据范围：<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo>≤</mo><mi>n</mi><mo separator=\"true\">,</mo><mi>m</mi><mo>≤</mo><mn>300</mn></mrow><annotation encoding=\"application/x-tex\">1 \\le n,m \\le 300</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7804em;vertical-align:-0.136em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8304em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">300</span></span></span></span>。</p><p>可以加 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span> 个点编号为 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>，将森林变为一棵树。\n考虑背包问题解法为设当前取了多少个元素。可以借鉴此方法，设 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>f</mi><mrow><mi>u</mi><mo separator=\"true\">,</mo><mi>i</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">f_{u,i}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9805em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">u</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\">i</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span> 为以 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span> 为根的子树选了 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span> 个节点的最大权值和。一个点如果选了，则它的父亲节点必定选了，那么每个节点的初始值为 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>。接着考虑每个背包的合并。</p><p>可得状态转移方程为：<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>f</mi><mrow><mi>u</mi><mo separator=\"true\">,</mo><mi>i</mi><mo>+</mo><mi>j</mi></mrow></msub><mo>=</mo><munder><mrow><mi>max</mi><mo>⁡</mo></mrow><mrow><mn>1</mn><mo>≤</mo><mi>i</mi><mo>≤</mo><mi>min</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mi>s</mi><mi>i</mi><msub><mi>z</mi><mi>u</mi></msub><mo separator=\"true\">,</mo><mi>m</mi><mo>+</mo><mn>1</mn><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo><mn>1</mn><mo>≤</mo><mi>j</mi><mo>≤</mo><mi>s</mi><mi>i</mi><msub><mi>z</mi><mi>v</mi></msub><mo separator=\"true\">,</mo><mi>i</mi><mo>+</mo><mi>j</mi><mo>≤</mo><mi>m</mi><mo>+</mo><mn>1</mn></mrow></munder><mo stretchy=\"false\">(</mo><msub><mi>f</mi><mrow><mi>u</mi><mo separator=\"true\">,</mo><mi>i</mi><mo>+</mo><mi>j</mi></mrow></msub><mo separator=\"true\">,</mo><msub><mi>f</mi><mrow><mi>u</mi><mo separator=\"true\">,</mo><mi>i</mi></mrow></msub><mo>+</mo><msub><mi>f</mi><mrow><mi>v</mi><mo separator=\"true\">,</mo><mi>j</mi></mrow></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">f_{u,i+j} = \\max \\limits_{1 \\le i \\le \\min(siz_{u},m+1),1 \\le j \\le siz_{v},i + j \\le m+1} (f_{u,i+j},f_{u,i}+f_{v,j})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9805em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">u</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">+</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.716em;vertical-align:-0.966em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4306em;\"><span style=\"top:-2.309em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span><span class=\"mrel mtight\">≤</span><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">≤</span><span class=\"mop mtight\"><span class=\"mtight\">m</span><span class=\"mtight\">i</span><span class=\"mtight\">n</span></span><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\">s</span><span class=\"mord mathnormal mtight\">i</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1645em;\"><span style=\"top:-2.357em;margin-left:-0.044em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">u</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\">m</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span><span class=\"mclose mtight\">)</span><span class=\"mpunct mtight\">,</span><span class=\"mord mtight\">1</span><span class=\"mrel mtight\">≤</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mrel mtight\">≤</span><span class=\"mord mathnormal mtight\">s</span><span class=\"mord mathnormal mtight\">i</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1645em;\"><span style=\"top:-2.357em;margin-left:-0.044em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">v</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">+</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mrel mtight\">≤</span><span class=\"mord mathnormal mtight\">m</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span><span class=\"mop\">max</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.966em;\"><span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">u</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">+</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">u</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\">i</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0361em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">v</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>。</p><div class=\"expressive-code\"><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"cpp\" class=\"wrap\" style=\"--ecMaxLine:88ch\"><code><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">1</div></div><div class=\"code\"><span style=\"--0:#F97583;--1:#F97583\">#include</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">&#x3C;bits/stdc++.h></span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">2</div></div><div class=\"code\"><span style=\"--0:#F97583;--1:#F97583\">using</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">namespace</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#B392F0;--1:#B392F0\">std</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">3</div></div><div class=\"code\"><span style=\"--0:#F97583;--1:#F97583\">const</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> N</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">3</span><span style=\"--0:#F97583;--1:#F97583\">e</span><span style=\"--0:#79B8FF;--1:#79B8FF\">2</span><span style=\"--0:#F97583;--1:#F97583\">+</span><span style=\"--0:#79B8FF;--1:#79B8FF\">5</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">4</div></div><div class=\"code\"><span style=\"--0:#F97583;--1:#F97583\">struct</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#B392F0;--1:#B392F0\">node</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">{</span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> to,next;}edge[N</span><span style=\"--0:#F97583;--1:#F97583\">&#x3C;&#x3C;</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">];</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">5</div></div><div class=\"code\"><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> n,m,w[N],head[N],cnt,f[N][N],g[N],siz[N];</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">6</div></div><div class=\"code\"><span style=\"--0:#F97583;--1:#F97583\">inline</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">void</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#B392F0;--1:#B392F0\">add</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#F97583;--1:#F97583\">const</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#FFAB70;--1:#FFAB70\">u</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,</span><span style=\"--0:#F97583;--1:#F97583\">const</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#FFAB70;--1:#FFAB70\">v</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">){</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">7</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">    </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">edge[</span><span style=\"--0:#F97583;--1:#F97583\">++</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">cnt].next</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">head[u];</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">8</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">    </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">edge[cnt].to</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">v;</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">9</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">    </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">head[u]</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">cnt;</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">10</div></div><div class=\"code\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">}</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">11</div></div><div class=\"code\"><span style=\"--0:#F97583;--1:#F97583\">namespace</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#B392F0;--1:#B392F0\">rw</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">{</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">12</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#F97583;--1:#F97583\">inline</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#B392F0;--1:#B392F0\">read</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(){</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">13</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> tot</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,t</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;</span><span style=\"--0:#F97583;--1:#F97583\">char</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> ch</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#B392F0;--1:#B392F0\">getchar</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">();</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">14</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#F97583;--1:#F97583\">while</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(ch</span><span style=\"--0:#F97583;--1:#F97583\">&#x3C;</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">'0'</span><span style=\"--0:#F97583;--1:#F97583\">||</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">ch</span><span style=\"--0:#F97583;--1:#F97583\">></span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">'9'</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">){</span><span style=\"--0:#F97583;--1:#F97583\">if</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(ch</span><span style=\"--0:#F97583;--1:#F97583\">==</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">'-'</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">) t</span><span style=\"--0:#F97583;--1:#F97583\">=-</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;ch</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#B392F0;--1:#B392F0\">getchar</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">();}</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">15</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#F97583;--1:#F97583\">while</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(ch</span><span style=\"--0:#F97583;--1:#F97583\">>=</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">'0'</span><span style=\"--0:#F97583;--1:#F97583\">&#x26;&#x26;</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">ch</span><span style=\"--0:#F97583;--1:#F97583\">&#x3C;=</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">'9'</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">){tot</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">tot</span><span style=\"--0:#F97583;--1:#F97583\">*</span><span style=\"--0:#79B8FF;--1:#79B8FF\">10</span><span style=\"--0:#F97583;--1:#F97583\">+</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">ch</span><span style=\"--0:#F97583;--1:#F97583\">-</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">'0'</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;ch</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#B392F0;--1:#B392F0\">getchar</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">();}</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">16</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#F97583;--1:#F97583\">return</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> tot</span><span style=\"--0:#F97583;--1:#F97583\">*</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">t;</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">17</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">    </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">}</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">18</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#F97583;--1:#F97583\">inline</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">void</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#B392F0;--1:#B392F0\">write</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#FFAB70;--1:#FFAB70\">x</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">){</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">19</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#F97583;--1:#F97583\">if</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(x</span><span style=\"--0:#F97583;--1:#F97583\">&#x3C;</span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">) </span><span style=\"--0:#B392F0;--1:#B392F0\">putchar</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">'-'</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">),x</span><span style=\"--0:#F97583;--1:#F97583\">=-</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">x;</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">20</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#F97583;--1:#F97583\">static</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> sta[</span><span style=\"--0:#79B8FF;--1:#79B8FF\">35</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">];</span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> top</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">21</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#F97583;--1:#F97583\">do</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">{sta[top</span><span style=\"--0:#F97583;--1:#F97583\">++</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">]</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">x</span><span style=\"--0:#F97583;--1:#F97583\">%</span><span style=\"--0:#79B8FF;--1:#79B8FF\">10</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,x</span><span style=\"--0:#F97583;--1:#F97583\">/=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">10</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;}</span><span style=\"--0:#F97583;--1:#F97583\">while</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(x);</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">22</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#F97583;--1:#F97583\">while</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(top) </span><span style=\"--0:#B392F0;--1:#B392F0\">putchar</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(sta[</span><span style=\"--0:#F97583;--1:#F97583\">--</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">top]</span><span style=\"--0:#F97583;--1:#F97583\">+</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">'0'</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">);</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">23</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">    </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">}</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">24</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#F97583;--1:#F97583\">inline</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">void</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#B392F0;--1:#B392F0\">file</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(){</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">25</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#B392F0;--1:#B392F0\">freopen</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">\".in\"</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">\"r\"</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,stdin);</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">26</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#B392F0;--1:#B392F0\">freopen</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">\".out\"</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">\"w\"</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,stdout);</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">27</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">    </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">}</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">28</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#F97583;--1:#F97583\">inline</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">void</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#B392F0;--1:#B392F0\">print</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#F97583;--1:#F97583\">const</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#FFAB70;--1:#FFAB70\">x</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,</span><span style=\"--0:#F97583;--1:#F97583\">const</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">char</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#FFAB70;--1:#FFAB70\">ch</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">){</span><span style=\"--0:#F97583;--1:#F97583\">return</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> (</span><span style=\"--0:#B392F0;--1:#B392F0\">write</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(x),</span><span style=\"--0:#B392F0;--1:#B392F0\">putchar</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(ch)),</span><span style=\"--0:#F97583;--1:#F97583\">void</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">);}</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">29</div></div><div class=\"code\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">}</span><span style=\"--0:#F97583;--1:#F97583\">using</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">namespace</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#B392F0;--1:#B392F0\">rw</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">30</div></div><div class=\"code\"><span style=\"--0:#F97583;--1:#F97583\">inline</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">void</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#B392F0;--1:#B392F0\">bag</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#F97583;--1:#F97583\">const</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#FFAB70;--1:#FFAB70\">u</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,</span><span style=\"--0:#F97583;--1:#F97583\">const</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#FFAB70;--1:#FFAB70\">v</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">){</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">31</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#F97583;--1:#F97583\">for</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> i</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;i</span><span style=\"--0:#F97583;--1:#F97583\">&#x3C;=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">siz[u];i</span><span style=\"--0:#F97583;--1:#F97583\">++</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">){</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">32</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#F97583;--1:#F97583\">for</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> j</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;j</span><span style=\"--0:#F97583;--1:#F97583\">&#x3C;=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">siz[v];j</span><span style=\"--0:#F97583;--1:#F97583\">++</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">){</span></div></div><div class=\"ec-line\" style=\"--ecIndent:12ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">33</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">            </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">g[i</span><span style=\"--0:#F97583;--1:#F97583\">+</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">j]</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#B392F0;--1:#B392F0\">max</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(g[i</span><span style=\"--0:#F97583;--1:#F97583\">+</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">j],f[u][i]</span><span style=\"--0:#F97583;--1:#F97583\">+</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">f[v][j]);</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">34</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">        </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">}</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">35</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">    </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">}</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">36</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">    </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">siz[u]</span><span style=\"--0:#F97583;--1:#F97583\">+=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">siz[v];</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">37</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#F97583;--1:#F97583\">for</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> i</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;i</span><span style=\"--0:#F97583;--1:#F97583\">&#x3C;=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">siz[u];i</span><span style=\"--0:#F97583;--1:#F97583\">++</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">) f[u][i]</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">g[i],g[i]</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">38</div></div><div class=\"code\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">}</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">39</div></div><div class=\"code\"><span style=\"--0:#F97583;--1:#F97583\">inline</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">void</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#B392F0;--1:#B392F0\">dfs</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#F97583;--1:#F97583\">const</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#FFAB70;--1:#FFAB70\">u</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">){</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">40</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">    </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">f[u][</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">]</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">w[u],siz[u]</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">41</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#F97583;--1:#F97583\">for</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> i</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">head[u];i;i</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">edge[i].next){</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">42</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> v</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">edge[i].to;</span><span style=\"--0:#B392F0;--1:#B392F0\">dfs</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(v);</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">43</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#B392F0;--1:#B392F0\">bag</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(u,v);</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">44</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">    </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">}</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">45</div></div><div class=\"code\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">}</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">46</div></div><div class=\"code\"><span style=\"--0:#F97583;--1:#F97583\">signed</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#B392F0;--1:#B392F0\">main</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(){</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">47</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">    </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">n</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#B392F0;--1:#B392F0\">read</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(),m</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#B392F0;--1:#B392F0\">read</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">();m</span><span style=\"--0:#F97583;--1:#F97583\">++</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">48</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#F97583;--1:#F97583\">for</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> i</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;i</span><span style=\"--0:#F97583;--1:#F97583\">&#x3C;=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">n;i</span><span style=\"--0:#F97583;--1:#F97583\">++</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">){</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">49</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> k</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#B392F0;--1:#B392F0\">read</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">();w[i]</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#B392F0;--1:#B392F0\">read</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">();</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">50</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#B392F0;--1:#B392F0\">add</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(k,i);</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">51</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">    </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">}</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">52</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#B392F0;--1:#B392F0\">dfs</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">);</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">53</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#B392F0;--1:#B392F0\">print</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(f[</span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">][m],</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">'</span><span style=\"--0:#79B8FF;--1:#79B8FF\">\\n</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">'</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">);</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">54</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#F97583;--1:#F97583\">return</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">55</div></div><div class=\"code\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">}</span></div></div></code><button class=\"copy-btn\" aria-label=\"Copy code\"><div class=\"copy-btn-icon\"><svg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon copy-icon\"><path d=\"M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z\"></path></svg><svg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon success-icon\"><path d=\"m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z\"></path></svg></div></button></pre></figure></div></section><section><h3 id=\"p11363-noip2024-树的遍历\"><a href=\"https://www.luogu.com.cn/problem/P11363\">P11363 [NOIP2024] 树的遍历</a><a class=\"anchor\" href=\"#p11363-noip2024-树的遍历\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h3><p>题意详见原题。</p><p>首先考虑 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">k=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span> 的答案。已经知道开始边，对于每一条边是从一条边转移过来，在以任意顺序遍历它的子树，则答案就是：<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>∏</mo><mrow><mo stretchy=\"false\">(</mo><mi>d</mi><mi>e</mi><msub><mi>g</mi><mi>i</mi></msub><mo>−</mo><mn>1</mn><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">!</mo></mrow></mrow><annotation encoding=\"application/x-tex\">\\prod{(deg_i-1)!}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">∏</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mopen\">(</span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">e</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)!</span></span></span></span></span>。\n接着考虑 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">k=2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span></span></span></span> 的答案。将两边连成一条链显然答案为 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>d</mi><mi>e</mi><msub><mi>g</mi><mi>i</mi></msub><mo>−</mo><mn>2</mn><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">!</mo></mrow><annotation encoding=\"application/x-tex\">(deg_i-2)!</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">e</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">2</span><span class=\"mclose\">)!</span></span></span></span>。\n<img src=\"https://cdn.luogu.com.cn/upload/image_hosting/hxos5ogw.png\" alt=\"\">\n上图中，红边为可能为起始边的边，蓝边为其中一种遍历方法。</p><p>然后，思考若起始边一定是一条从叶子节点出发去往叶子节点的一条链。证明：考虑一个点的周围全是黑边，这些边内部的蓝边一定为一条链，对于一条链来说，起始边必然为链的一端。当一条链确定是答案为：<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>∏</mo><mrow><mo stretchy=\"false\">(</mo><mi>d</mi><mi>e</mi><msub><mi>g</mi><mi>i</mi></msub><mo>−</mo><mn>1</mn><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">!</mo></mrow><mo>×</mo><mo>∏</mo><mrow><mo stretchy=\"false\">(</mo><mi>d</mi><mi>e</mi><msub><mi>g</mi><mi>u</mi></msub><mo>−</mo><mn>1</mn><msup><mo stretchy=\"false\">)</mo><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow></mrow><annotation encoding=\"application/x-tex\">\\prod{(deg_i-1)!} \\times \\prod{(deg_u-1)^{-1}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">∏</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mopen\">(</span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">e</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)!</span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">∏</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mopen\">(</span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">e</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">u</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">1</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span></span></span></span></span>，<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span> 为所有点，<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span> 为链上的节点。</p><p>现在问题转化为：<strong>有一棵边权为 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn><mi mathvariant=\"normal\">/</mi><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">0/1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">0/1</span></span></span></span> 的树，点有点权，求所有叶子到叶子的链，满足链上有一条 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span> 的边，点的权值乘积的和</strong>。</p><p>对于这个问题可以取一个非叶子节点做根，记录每个子树内有无 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span> 总和为 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi><msub><mi>p</mi><mrow><mi>u</mi><mo separator=\"true\">,</mo><mn>0</mn><mi mathvariant=\"normal\">/</mi><mn>1</mn></mrow></msub></mrow><annotation encoding=\"application/x-tex\">dp_{u,0/1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0496em;vertical-align:-0.3552em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.5198em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">u</span><span class=\"mpunct mtight\">,</span><span class=\"mord mtight\">0/1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3552em;\"><span></span></span></span></span></span></span></span></span></span>，计算贡献即可。</p><div class=\"expressive-code\"><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"cpp\" class=\"wrap\" style=\"--ecMaxLine:88ch\"><code><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">1</div></div><div class=\"code\"><span style=\"--0:#F97583;--1:#F97583\">#include</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">&#x3C;bits/stdc++.h></span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">2</div></div><div class=\"code\"><span style=\"--0:#F97583;--1:#F97583\">#define</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#B392F0;--1:#B392F0\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">long</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">long</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">3</div></div><div class=\"code\"><span style=\"--0:#F97583;--1:#F97583\">using</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">namespace</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#B392F0;--1:#B392F0\">std</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">4</div></div><div class=\"code\"><span style=\"--0:#F97583;--1:#F97583\">const</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> N</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#F97583;--1:#F97583\">e</span><span style=\"--0:#79B8FF;--1:#79B8FF\">5</span><span style=\"--0:#F97583;--1:#F97583\">+</span><span style=\"--0:#79B8FF;--1:#79B8FF\">5</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,mod</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#F97583;--1:#F97583\">e</span><span style=\"--0:#79B8FF;--1:#79B8FF\">9</span><span style=\"--0:#F97583;--1:#F97583\">+</span><span style=\"--0:#79B8FF;--1:#79B8FF\">7</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">5</div></div><div class=\"code\"><span style=\"--0:#F97583;--1:#F97583\">struct</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#B392F0;--1:#B392F0\">node</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">{</span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> to,next,flag;}edge[N</span><span style=\"--0:#F97583;--1:#F97583\">&#x3C;&#x3C;</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">];</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">6</div></div><div class=\"code\"><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> n,k,head[N],cnt,chose[N],du[N],u[N],v[N],ans,f[N][</span><span style=\"--0:#79B8FF;--1:#79B8FF\">2</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">],inv[N];</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">7</div></div><div class=\"code\"><span style=\"--0:#F97583;--1:#F97583\">inline</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">void</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#B392F0;--1:#B392F0\">add</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#F97583;--1:#F97583\">const</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#FFAB70;--1:#FFAB70\">u</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,</span><span style=\"--0:#F97583;--1:#F97583\">const</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#FFAB70;--1:#FFAB70\">v</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,</span><span style=\"--0:#F97583;--1:#F97583\">const</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#FFAB70;--1:#FFAB70\">flag</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">){</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">8</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">    </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">edge[</span><span style=\"--0:#F97583;--1:#F97583\">++</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">cnt].next</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">head[u];</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">9</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">    </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">edge[cnt].to</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">v;</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">10</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">    </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">edge[cnt].flag</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">flag;</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">11</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">    </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">head[u]</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">cnt;</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">12</div></div><div class=\"code\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">}</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">13</div></div><div class=\"code\"><span style=\"--0:#F97583;--1:#F97583\">namespace</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#B392F0;--1:#B392F0\">rw</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">{</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">14</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#F97583;--1:#F97583\">inline</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#B392F0;--1:#B392F0\">read</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(){</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">15</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> tot</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,t</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;</span><span style=\"--0:#F97583;--1:#F97583\">char</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> ch</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#B392F0;--1:#B392F0\">getchar</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">();</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">16</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#F97583;--1:#F97583\">while</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(ch</span><span style=\"--0:#F97583;--1:#F97583\">&#x3C;</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">'0'</span><span style=\"--0:#F97583;--1:#F97583\">||</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">ch</span><span style=\"--0:#F97583;--1:#F97583\">></span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">'9'</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">){</span><span style=\"--0:#F97583;--1:#F97583\">if</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(ch</span><span style=\"--0:#F97583;--1:#F97583\">==</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">'-'</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">) t</span><span style=\"--0:#F97583;--1:#F97583\">=-</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;ch</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#B392F0;--1:#B392F0\">getchar</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">();}</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">17</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#F97583;--1:#F97583\">while</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(ch</span><span style=\"--0:#F97583;--1:#F97583\">>=</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">'0'</span><span style=\"--0:#F97583;--1:#F97583\">&#x26;&#x26;</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">ch</span><span style=\"--0:#F97583;--1:#F97583\">&#x3C;=</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">'9'</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">){tot</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">tot</span><span style=\"--0:#F97583;--1:#F97583\">*</span><span style=\"--0:#79B8FF;--1:#79B8FF\">10</span><span style=\"--0:#F97583;--1:#F97583\">+</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">ch</span><span style=\"--0:#F97583;--1:#F97583\">-</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">'0'</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;ch</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#B392F0;--1:#B392F0\">getchar</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">();}</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">18</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#F97583;--1:#F97583\">return</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> tot</span><span style=\"--0:#F97583;--1:#F97583\">*</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">t;</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">19</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">    </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">}</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">20</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#F97583;--1:#F97583\">inline</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">void</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#B392F0;--1:#B392F0\">write</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#FFAB70;--1:#FFAB70\">x</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">){</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">21</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#F97583;--1:#F97583\">if</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(x</span><span style=\"--0:#F97583;--1:#F97583\">&#x3C;</span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">) </span><span style=\"--0:#B392F0;--1:#B392F0\">putchar</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">'-'</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">),x</span><span style=\"--0:#F97583;--1:#F97583\">=-</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">x;</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">22</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#F97583;--1:#F97583\">static</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> sta[</span><span style=\"--0:#79B8FF;--1:#79B8FF\">35</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">];</span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> top</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">23</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#F97583;--1:#F97583\">do</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">{sta[top</span><span style=\"--0:#F97583;--1:#F97583\">++</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">]</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">x</span><span style=\"--0:#F97583;--1:#F97583\">%</span><span style=\"--0:#79B8FF;--1:#79B8FF\">10</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,x</span><span style=\"--0:#F97583;--1:#F97583\">/=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">10</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;}</span><span style=\"--0:#F97583;--1:#F97583\">while</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(x);</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">24</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#F97583;--1:#F97583\">while</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(top) </span><span style=\"--0:#B392F0;--1:#B392F0\">putchar</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(sta[</span><span style=\"--0:#F97583;--1:#F97583\">--</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">top]</span><span style=\"--0:#F97583;--1:#F97583\">+</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">'0'</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">);</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">25</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">    </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">}</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">26</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#F97583;--1:#F97583\">inline</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">void</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#B392F0;--1:#B392F0\">file</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(){</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">27</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#B392F0;--1:#B392F0\">freopen</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">\".in\"</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">\"r\"</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,stdin);</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">28</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#B392F0;--1:#B392F0\">freopen</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">\".out\"</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">\"w\"</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,stdout);</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">29</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">    </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">}</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">30</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#F97583;--1:#F97583\">inline</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">void</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#B392F0;--1:#B392F0\">print</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#F97583;--1:#F97583\">const</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#FFAB70;--1:#FFAB70\">x</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,</span><span style=\"--0:#F97583;--1:#F97583\">const</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">char</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#FFAB70;--1:#FFAB70\">ch</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">){</span><span style=\"--0:#F97583;--1:#F97583\">return</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> (</span><span style=\"--0:#B392F0;--1:#B392F0\">write</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(x),</span><span style=\"--0:#B392F0;--1:#B392F0\">putchar</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(ch)),</span><span style=\"--0:#F97583;--1:#F97583\">void</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">);}</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">31</div></div><div class=\"code\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">}</span><span style=\"--0:#F97583;--1:#F97583\">using</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">namespace</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#B392F0;--1:#B392F0\">rw</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">32</div></div><div class=\"code\"><span style=\"--0:#F97583;--1:#F97583\">inline</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">void</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#B392F0;--1:#B392F0\">dfs</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#F97583;--1:#F97583\">const</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#FFAB70;--1:#FFAB70\">u</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,</span><span style=\"--0:#F97583;--1:#F97583\">const</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#FFAB70;--1:#FFAB70\">fa</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">){</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">33</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">    </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">f[u][</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">]</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">f[u][</span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">]</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;</span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> val</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">34</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#F97583;--1:#F97583\">for</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> i</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">head[u];i;i</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">edge[i].next){</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">35</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> v</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">edge[i].to,flag</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">edge[i].flag;</span><span style=\"--0:#F97583;--1:#F97583\">if</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(fa</span><span style=\"--0:#F97583;--1:#F97583\">==</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">v) </span><span style=\"--0:#F97583;--1:#F97583\">continue</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;</span><span style=\"--0:#B392F0;--1:#B392F0\">dfs</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(v,u);</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">36</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#F97583;--1:#F97583\">if</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(flag) f[v][</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">]</span><span style=\"--0:#F97583;--1:#F97583\">+=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">f[v][</span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">],f[v][</span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">]</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">37</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">        </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">val</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(val</span><span style=\"--0:#F97583;--1:#F97583\">+</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">f[v][</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">]</span><span style=\"--0:#F97583;--1:#F97583\">*</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(f[u][</span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">]</span><span style=\"--0:#F97583;--1:#F97583\">+</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">f[u][</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">])</span><span style=\"--0:#F97583;--1:#F97583\">+</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">f[v][</span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">]</span><span style=\"--0:#F97583;--1:#F97583\">*</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">f[u][</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">])</span><span style=\"--0:#F97583;--1:#F97583\">%</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">mod;</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">38</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">        </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">f[u][</span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">]</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(f[u][</span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">]</span><span style=\"--0:#F97583;--1:#F97583\">+</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">f[v][</span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">])</span><span style=\"--0:#F97583;--1:#F97583\">%</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">mod,f[u][</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">]</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(f[u][</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">]</span><span style=\"--0:#F97583;--1:#F97583\">+</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">f[v][</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">])</span><span style=\"--0:#F97583;--1:#F97583\">%</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">mod;</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">39</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">    </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">}</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">40</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> INV</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">inv[du[u]];ans</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(ans</span><span style=\"--0:#F97583;--1:#F97583\">+</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">val</span><span style=\"--0:#F97583;--1:#F97583\">*</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">INV)</span><span style=\"--0:#F97583;--1:#F97583\">%</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">mod;</span><span style=\"--0:#F97583;--1:#F97583\">if</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#F97583;--1:#F97583\">!</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">du[u]) f[u][</span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">]</span><span style=\"--0:#F97583;--1:#F97583\">++</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">41</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">    </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">f[u][</span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">]</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(f[u][</span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">]</span><span style=\"--0:#F97583;--1:#F97583\">*</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">INV)</span><span style=\"--0:#F97583;--1:#F97583\">%</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">mod;</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">42</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">    </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">f[u][</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">]</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(f[u][</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">]</span><span style=\"--0:#F97583;--1:#F97583\">*</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">INV)</span><span style=\"--0:#F97583;--1:#F97583\">%</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">mod;</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">43</div></div><div class=\"code\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">}</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">44</div></div><div class=\"code\"><span style=\"--0:#F97583;--1:#F97583\">inline</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">void</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#B392F0;--1:#B392F0\">init</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(){</span><span style=\"--0:#F97583;--1:#F97583\">for</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> i</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;i</span><span style=\"--0:#F97583;--1:#F97583\">&#x3C;=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">n;i</span><span style=\"--0:#F97583;--1:#F97583\">++</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">) head[i]</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,du[i]</span><span style=\"--0:#F97583;--1:#F97583\">=-</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,chose[i]</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;cnt</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,ans</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;}</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">45</div></div><div class=\"code\"><span style=\"--0:#F97583;--1:#F97583\">inline</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">void</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#B392F0;--1:#B392F0\">solve</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(){</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">46</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">    </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">n</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#B392F0;--1:#B392F0\">read</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(),k</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#B392F0;--1:#B392F0\">read</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">();</span><span style=\"--0:#B392F0;--1:#B392F0\">init</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">();</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">47</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#F97583;--1:#F97583\">for</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> i</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;i</span><span style=\"--0:#F97583;--1:#F97583\">&#x3C;</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">n;i</span><span style=\"--0:#F97583;--1:#F97583\">++</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">){u[i]</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#B392F0;--1:#B392F0\">read</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(),v[i]</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#B392F0;--1:#B392F0\">read</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">();du[u[i]]</span><span style=\"--0:#F97583;--1:#F97583\">++</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,du[v[i]]</span><span style=\"--0:#F97583;--1:#F97583\">++</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;}</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">48</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#F97583;--1:#F97583\">for</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> i</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;i</span><span style=\"--0:#F97583;--1:#F97583\">&#x3C;=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">k;i</span><span style=\"--0:#F97583;--1:#F97583\">++</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">){</span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> x</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#B392F0;--1:#B392F0\">read</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">();chose[x]</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;}</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">49</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#F97583;--1:#F97583\">if</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(n</span><span style=\"--0:#F97583;--1:#F97583\">==</span><span style=\"--0:#79B8FF;--1:#79B8FF\">2</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">) </span><span style=\"--0:#F97583;--1:#F97583\">return</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#B392F0;--1:#B392F0\">print</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">'</span><span style=\"--0:#79B8FF;--1:#79B8FF\">\\n</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">'</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">),</span><span style=\"--0:#F97583;--1:#F97583\">void</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">);</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">50</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#F97583;--1:#F97583\">for</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> i</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;i</span><span style=\"--0:#F97583;--1:#F97583\">&#x3C;</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">n;i</span><span style=\"--0:#F97583;--1:#F97583\">++</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">) </span><span style=\"--0:#B392F0;--1:#B392F0\">add</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(u[i],v[i],chose[i]),</span><span style=\"--0:#B392F0;--1:#B392F0\">add</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(v[i],u[i],chose[i]);</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">51</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> rt</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;</span><span style=\"--0:#F97583;--1:#F97583\">for</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> i</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;i</span><span style=\"--0:#F97583;--1:#F97583\">&#x3C;=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">n;i</span><span style=\"--0:#F97583;--1:#F97583\">++</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">) </span><span style=\"--0:#F97583;--1:#F97583\">if</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(du[i]) rt</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">i;</span><span style=\"--0:#B392F0;--1:#B392F0\">dfs</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(rt,</span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">);</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">52</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#F97583;--1:#F97583\">for</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> i</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;i</span><span style=\"--0:#F97583;--1:#F97583\">&#x3C;=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">n;i</span><span style=\"--0:#F97583;--1:#F97583\">++</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">) </span><span style=\"--0:#F97583;--1:#F97583\">for</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> j</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;j</span><span style=\"--0:#F97583;--1:#F97583\">&#x3C;=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">du[i];j</span><span style=\"--0:#F97583;--1:#F97583\">++</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">) ans</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(ans</span><span style=\"--0:#F97583;--1:#F97583\">*</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">j)</span><span style=\"--0:#F97583;--1:#F97583\">%</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">mod;</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">53</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#B392F0;--1:#B392F0\">print</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(ans,</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">'</span><span style=\"--0:#79B8FF;--1:#79B8FF\">\\n</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">'</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">);</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">54</div></div><div class=\"code\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">}</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">55</div></div><div class=\"code\"><span style=\"--0:#F97583;--1:#F97583\">signed</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#B392F0;--1:#B392F0\">main</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(){</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">56</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">    </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">inv[</span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">]</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">inv[</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">]</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">57</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#F97583;--1:#F97583\">for</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> i</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">2</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;i</span><span style=\"--0:#F97583;--1:#F97583\">&#x3C;=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">N;i</span><span style=\"--0:#F97583;--1:#F97583\">++</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">) inv[i]</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">inv[mod</span><span style=\"--0:#F97583;--1:#F97583\">%</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">i]</span><span style=\"--0:#F97583;--1:#F97583\">*</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(mod</span><span style=\"--0:#F97583;--1:#F97583\">-</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">mod</span><span style=\"--0:#F97583;--1:#F97583\">/</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">i)</span><span style=\"--0:#F97583;--1:#F97583\">%</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">mod;</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">58</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> c</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#B392F0;--1:#B392F0\">read</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(),T</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#B392F0;--1:#B392F0\">read</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">();</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">59</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#F97583;--1:#F97583\">while</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(T</span><span style=\"--0:#F97583;--1:#F97583\">--</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">) </span><span style=\"--0:#B392F0;--1:#B392F0\">solve</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">();</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">60</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#F97583;--1:#F97583\">return</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">61</div></div><div class=\"code\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">}</span></div></div></code><button class=\"copy-btn\" aria-label=\"Copy code\"><div class=\"copy-btn-icon\"><svg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon copy-icon\"><path d=\"M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z\"></path></svg><svg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon success-icon\"><path d=\"m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z\"></path></svg></div></button></pre></figure></div></section></section><section><h2 id=\"换根-dptextdpdp\">换根 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>DP</mtext></mrow><annotation encoding=\"application/x-tex\">\\text{DP}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord text\"><span class=\"mord\">DP</span></span></span></span></span><a class=\"anchor\" href=\"#换根-dptextdpdp\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h2><p>树形换根 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>DP</mtext></mrow><annotation encoding=\"application/x-tex\">\\text{DP}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord text\"><span class=\"mord\">DP</span></span></span></span></span> 问题又称为<em>二次扫描</em>，通常不会指定树的根，且随着根的变换某些值也会发生改变，如子节点深度和、点权值和。\n通常进行两次 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>DFS</mtext></mrow><annotation encoding=\"application/x-tex\">\\text{DFS}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord text\"><span class=\"mord\">DFS</span></span></span></span></span>，第一次 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>DFS</mtext></mrow><annotation encoding=\"application/x-tex\">\\text{DFS}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord text\"><span class=\"mord\">DFS</span></span></span></span></span> 求出子树内的值，第二次 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>DFS</mtext></mrow><annotation encoding=\"application/x-tex\">\\text{DFS}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord text\"><span class=\"mord\">DFS</span></span></span></span></span> 进行换根操作。</p><section><h3 id=\"例题p3478-poi-2008-sta-station\">例题：<a href=\"https://www.luogu.com.cn/problem/P3478\">P3478 [POI 2008] STA-Station</a><a class=\"anchor\" href=\"#例题p3478-poi-2008-sta-station\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h3><p>给定一个 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span> 个点的树，请求出一个结点，使得以这个结点为根时，所有结点的深度之和最大。\n一个结点的深度之定义为该节点到根的简单路径上边的数量。\n对于全部的测试点，保证 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo>≤</mo><mi>n</mi><mo>≤</mo><msup><mn>10</mn><mn>6</mn></msup><mo separator=\"true\">,</mo><mn>1</mn><mo>≤</mo><mi>u</mi><mo separator=\"true\">,</mo><mi>v</mi><mo>≤</mo><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">1 \\le n \\le 10^{6},1 \\le u,v \\le n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7804em;vertical-align:-0.136em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7719em;vertical-align:-0.136em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0085em;vertical-align:-0.1944em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">6</span></span></span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8304em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>，给出的是一棵树。</p><p>很明显换根 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>DP</mtext></mrow><annotation encoding=\"application/x-tex\">\\text{DP}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord text\"><span class=\"mord\">DP</span></span></span></span></span>。对于第一次 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>DFS</mtext></mrow><annotation encoding=\"application/x-tex\">\\text{DFS}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord text\"><span class=\"mord\">DFS</span></span></span></span></span> 求出以 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span> 为根的 每个子树的深度和&#x26;每个子树的大小，将每个子树的深度加入 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>f</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">f_{1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>。对于第二次 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>DFS</mtext></mrow><annotation encoding=\"application/x-tex\">\\text{DFS}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord text\"><span class=\"mord\">DFS</span></span></span></span></span> 考虑换根，将根为 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span> 转换为 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>v</mi></mrow><annotation encoding=\"application/x-tex\">v</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span></span></span></span>，则根为 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>v</mi></mrow><annotation encoding=\"application/x-tex\">v</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span></span></span></span> 的子树的深度 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>−</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">-1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">−</span><span class=\"mord\">1</span></span></span></span>，其他 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>+</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">+1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">+</span><span class=\"mord\">1</span></span></span></span>，转移方程为：<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>f</mi><mi>v</mi></msub><mo>=</mo><msub><mi>f</mi><mi>u</mi></msub><mo>+</mo><mi>n</mi><mo>−</mo><mn>2</mn><mo>×</mo><mi>s</mi><mi>i</mi><msub><mi>z</mi><mi>v</mi></msub></mrow><annotation encoding=\"application/x-tex\">f_{v}=f_{u}+n-2 \\times siz_{v}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">v</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">u</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">2</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8095em;vertical-align:-0.15em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">i</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.044em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">v</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>。最后将所有的 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>f</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">f_{i}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 最大值输出即可。</p><div class=\"expressive-code\"><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"cpp\" class=\"wrap\" style=\"--ecMaxLine:88ch\"><code><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">1</div></div><div class=\"code\"><span style=\"--0:#F97583;--1:#F97583\">#include</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">&#x3C;bits/stdc++.h></span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">2</div></div><div class=\"code\"><span style=\"--0:#F97583;--1:#F97583\">#define</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#B392F0;--1:#B392F0\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">long</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">long</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">3</div></div><div class=\"code\"><span style=\"--0:#F97583;--1:#F97583\">using</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">namespace</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#B392F0;--1:#B392F0\">std</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">4</div></div><div class=\"code\"><span style=\"--0:#F97583;--1:#F97583\">const</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> N</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#F97583;--1:#F97583\">e</span><span style=\"--0:#79B8FF;--1:#79B8FF\">6</span><span style=\"--0:#F97583;--1:#F97583\">+</span><span style=\"--0:#79B8FF;--1:#79B8FF\">5</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">5</div></div><div class=\"code\"><span style=\"--0:#F97583;--1:#F97583\">struct</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#B392F0;--1:#B392F0\">node</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">{</span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> to,next;}edge[N</span><span style=\"--0:#F97583;--1:#F97583\">&#x3C;&#x3C;</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">];</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">6</div></div><div class=\"code\"><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> n,head[N],cnt,siz[N],dep[N],f[N],ans,maxn;</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">7</div></div><div class=\"code\"><span style=\"--0:#F97583;--1:#F97583\">inline</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">void</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#B392F0;--1:#B392F0\">add</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#F97583;--1:#F97583\">const</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#FFAB70;--1:#FFAB70\">u</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,</span><span style=\"--0:#F97583;--1:#F97583\">const</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#FFAB70;--1:#FFAB70\">v</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">){</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">8</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">    </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">edge[</span><span style=\"--0:#F97583;--1:#F97583\">++</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">cnt].next</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">head[u];</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">9</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">    </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">edge[cnt].to</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">v;</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">10</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">    </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">head[u]</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">cnt;</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">11</div></div><div class=\"code\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">}</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">12</div></div><div class=\"code\"><span style=\"--0:#F97583;--1:#F97583\">namespace</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#B392F0;--1:#B392F0\">rw</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">{</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">13</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#F97583;--1:#F97583\">inline</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#B392F0;--1:#B392F0\">read</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(){</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">14</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> tot</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,t</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;</span><span style=\"--0:#F97583;--1:#F97583\">char</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> ch</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#B392F0;--1:#B392F0\">getchar</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">();</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">15</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#F97583;--1:#F97583\">while</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(ch</span><span style=\"--0:#F97583;--1:#F97583\">&#x3C;</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">'0'</span><span style=\"--0:#F97583;--1:#F97583\">||</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">ch</span><span style=\"--0:#F97583;--1:#F97583\">></span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">'9'</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">){</span><span style=\"--0:#F97583;--1:#F97583\">if</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(ch</span><span style=\"--0:#F97583;--1:#F97583\">==</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">'-'</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">) t</span><span style=\"--0:#F97583;--1:#F97583\">=-</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;ch</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#B392F0;--1:#B392F0\">getchar</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">();}</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">16</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#F97583;--1:#F97583\">while</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(ch</span><span style=\"--0:#F97583;--1:#F97583\">>=</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">'0'</span><span style=\"--0:#F97583;--1:#F97583\">&#x26;&#x26;</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">ch</span><span style=\"--0:#F97583;--1:#F97583\">&#x3C;=</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">'9'</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">){tot</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">tot</span><span style=\"--0:#F97583;--1:#F97583\">*</span><span style=\"--0:#79B8FF;--1:#79B8FF\">10</span><span style=\"--0:#F97583;--1:#F97583\">+</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">ch</span><span style=\"--0:#F97583;--1:#F97583\">-</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">'0'</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;ch</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#B392F0;--1:#B392F0\">getchar</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">();}</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">17</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#F97583;--1:#F97583\">return</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> tot</span><span style=\"--0:#F97583;--1:#F97583\">*</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">t;</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">18</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">    </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">}</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">19</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#F97583;--1:#F97583\">inline</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">void</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#B392F0;--1:#B392F0\">write</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#FFAB70;--1:#FFAB70\">x</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">){</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">20</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#F97583;--1:#F97583\">if</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(x</span><span style=\"--0:#F97583;--1:#F97583\">&#x3C;</span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">) </span><span style=\"--0:#B392F0;--1:#B392F0\">putchar</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">'-'</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">),x</span><span style=\"--0:#F97583;--1:#F97583\">=-</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">x;</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">21</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#F97583;--1:#F97583\">static</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> sta[</span><span style=\"--0:#79B8FF;--1:#79B8FF\">35</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">];</span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> top</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">22</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#F97583;--1:#F97583\">do</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">{sta[top</span><span style=\"--0:#F97583;--1:#F97583\">++</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">]</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">x</span><span style=\"--0:#F97583;--1:#F97583\">%</span><span style=\"--0:#79B8FF;--1:#79B8FF\">10</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,x</span><span style=\"--0:#F97583;--1:#F97583\">/=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">10</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;}</span><span style=\"--0:#F97583;--1:#F97583\">while</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(x);</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">23</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#F97583;--1:#F97583\">while</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(top) </span><span style=\"--0:#B392F0;--1:#B392F0\">putchar</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(sta[</span><span style=\"--0:#F97583;--1:#F97583\">--</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">top]</span><span style=\"--0:#F97583;--1:#F97583\">+</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">'0'</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">);</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">24</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">    </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">}</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">25</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#F97583;--1:#F97583\">inline</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">void</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#B392F0;--1:#B392F0\">file</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(){</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">26</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#B392F0;--1:#B392F0\">freopen</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">\".in\"</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">\"r\"</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,stdin);</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">27</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#B392F0;--1:#B392F0\">freopen</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">\".out\"</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">\"w\"</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,stdout);</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">28</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">    </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">}</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">29</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#F97583;--1:#F97583\">inline</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">void</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#B392F0;--1:#B392F0\">print</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#F97583;--1:#F97583\">const</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#FFAB70;--1:#FFAB70\">x</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,</span><span style=\"--0:#F97583;--1:#F97583\">const</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">char</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#FFAB70;--1:#FFAB70\">ch</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">){</span><span style=\"--0:#F97583;--1:#F97583\">return</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> (</span><span style=\"--0:#B392F0;--1:#B392F0\">write</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(x),</span><span style=\"--0:#B392F0;--1:#B392F0\">putchar</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(ch)),</span><span style=\"--0:#F97583;--1:#F97583\">void</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">);}</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">30</div></div><div class=\"code\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">}</span><span style=\"--0:#F97583;--1:#F97583\">using</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">namespace</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#B392F0;--1:#B392F0\">rw</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">31</div></div><div class=\"code\"><span style=\"--0:#F97583;--1:#F97583\">inline</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">void</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#B392F0;--1:#B392F0\">dfs_init</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#F97583;--1:#F97583\">const</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#FFAB70;--1:#FFAB70\">u</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,</span><span style=\"--0:#F97583;--1:#F97583\">const</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#FFAB70;--1:#FFAB70\">fa</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">){</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">32</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">    </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">siz[u]</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,dep[u]</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">dep[fa]</span><span style=\"--0:#F97583;--1:#F97583\">+</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">33</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#F97583;--1:#F97583\">for</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> i</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">head[u];i;i</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">edge[i].next){</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">34</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> v</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">edge[i].to;</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">35</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#F97583;--1:#F97583\">if</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(fa</span><span style=\"--0:#F97583;--1:#F97583\">==</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">v) </span><span style=\"--0:#F97583;--1:#F97583\">continue</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">36</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#B392F0;--1:#B392F0\">dfs_init</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(v,u);siz[u]</span><span style=\"--0:#F97583;--1:#F97583\">+=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">siz[v];</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">37</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">    </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">}</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">38</div></div><div class=\"code\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">}</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">39</div></div><div class=\"code\"><span style=\"--0:#F97583;--1:#F97583\">inline</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">void</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#B392F0;--1:#B392F0\">dfs_do</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#F97583;--1:#F97583\">const</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#FFAB70;--1:#FFAB70\">u</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,</span><span style=\"--0:#F97583;--1:#F97583\">const</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#FFAB70;--1:#FFAB70\">fa</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">){</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">40</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#F97583;--1:#F97583\">for</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> i</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">head[u];i;i</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">edge[i].next){</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">41</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> v</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">edge[i].to;</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">42</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#F97583;--1:#F97583\">if</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(fa</span><span style=\"--0:#F97583;--1:#F97583\">==</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">v) </span><span style=\"--0:#F97583;--1:#F97583\">continue</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">43</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">        </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">f[v]</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">f[u]</span><span style=\"--0:#F97583;--1:#F97583\">+</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">n</span><span style=\"--0:#F97583;--1:#F97583\">-</span><span style=\"--0:#79B8FF;--1:#79B8FF\">2</span><span style=\"--0:#F97583;--1:#F97583\">*</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">siz[v];</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">44</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#B392F0;--1:#B392F0\">dfs_do</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(v,u);</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">45</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">    </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">}</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">46</div></div><div class=\"code\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">}</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">47</div></div><div class=\"code\"><span style=\"--0:#F97583;--1:#F97583\">signed</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#B392F0;--1:#B392F0\">main</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(){</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">48</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">    </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">n</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#B392F0;--1:#B392F0\">read</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">();</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">49</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#F97583;--1:#F97583\">for</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> i</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;i</span><span style=\"--0:#F97583;--1:#F97583\">&#x3C;</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">n;i</span><span style=\"--0:#F97583;--1:#F97583\">++</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">){</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">50</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> u</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#B392F0;--1:#B392F0\">read</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(),v</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#B392F0;--1:#B392F0\">read</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">();</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">51</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#B392F0;--1:#B392F0\">add</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(u,v),</span><span style=\"--0:#B392F0;--1:#B392F0\">add</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(v,u);</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">52</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">    </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">}</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">53</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#B392F0;--1:#B392F0\">dfs_init</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,</span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">);</span><span style=\"--0:#F97583;--1:#F97583\">for</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> i</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;i</span><span style=\"--0:#F97583;--1:#F97583\">&#x3C;=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">n;i</span><span style=\"--0:#F97583;--1:#F97583\">++</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">) f[</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">]</span><span style=\"--0:#F97583;--1:#F97583\">+=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">dep[i];</span><span style=\"--0:#B392F0;--1:#B392F0\">dfs_do</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,</span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">);</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">54</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#F97583;--1:#F97583\">for</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> i</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;i</span><span style=\"--0:#F97583;--1:#F97583\">&#x3C;=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">n;i</span><span style=\"--0:#F97583;--1:#F97583\">++</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">) </span><span style=\"--0:#F97583;--1:#F97583\">if</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(maxn</span><span style=\"--0:#F97583;--1:#F97583\">&#x3C;</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">f[i]) maxn</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">f[i],ans</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">i;</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">55</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#B392F0;--1:#B392F0\">print</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(ans,</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">'</span><span style=\"--0:#79B8FF;--1:#79B8FF\">\\n</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">'</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">);</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">56</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#F97583;--1:#F97583\">return</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">57</div></div><div class=\"code\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">}</span></div></div></code><button class=\"copy-btn\" aria-label=\"Copy code\"><div class=\"copy-btn-icon\"><svg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon copy-icon\"><path d=\"M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z\"></path></svg><svg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon success-icon\"><path d=\"m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z\"></path></svg></div></button></pre></figure></div><hr></section></section></section>\n<section><h1 id=\"状压-dptextdpdp\">状压 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>DP</mtext></mrow><annotation encoding=\"application/x-tex\">\\text{DP}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord text\"><span class=\"mord\">DP</span></span></span></span></span><a class=\"anchor\" href=\"#状压-dptextdpdp\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h1><p>状压 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>DP</mtext></mrow><annotation encoding=\"application/x-tex\">\\text{DP}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord text\"><span class=\"mord\">DP</span></span></span></span></span> 是动态规划的一种，通过将状态压缩为整数来达到优化转移的目的。是利用计算机二进制的性质来描述状态的一种 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>DP</mtext></mrow><annotation encoding=\"application/x-tex\">\\text{DP}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord text\"><span class=\"mord\">DP</span></span></span></span></span> 方式。</p><p>状压 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>DP</mtext></mrow><annotation encoding=\"application/x-tex\">\\text{DP}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord text\"><span class=\"mord\">DP</span></span></span></span></span> 其实就是将状态压缩成 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span></span></span></span> 进制来保存 其特征就是看起来有点像搜索，每个格子的状态只有 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span> 或 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>，是另一类非常典型的动态规划。</p><p>为了更好的理解状压 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>DP</mtext></mrow><annotation encoding=\"application/x-tex\">\\text{DP}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord text\"><span class=\"mord\">DP</span></span></span></span></span>，首先介绍<strong>位运算</strong>相关的知识。</p><ul>\n<li><code>&#x26;</code>符号，<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mi mathvariant=\"normal\">&#x26;</mi><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">x \\&#x26; y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mord\">&#x26;</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>，会将两个十进制数在二进制下进行与运算（都 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span> 为 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>，其余为 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>） 然后返回其十进制下的值。例如<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>3</mn><mo stretchy=\"false\">(</mo><mn>11</mn><mo stretchy=\"false\">)</mo><mi mathvariant=\"normal\">&#x26;</mi><mn>2</mn><mo stretchy=\"false\">(</mo><mn>10</mn><mo stretchy=\"false\">)</mo><mo>=</mo><mn>2</mn><mo stretchy=\"false\">(</mo><mn>10</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">3(11)\\&#x26;2(10)=2(10)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">3</span><span class=\"mopen\">(</span><span class=\"mord\">11</span><span class=\"mclose\">)</span><span class=\"mord\">&#x26;2</span><span class=\"mopen\">(</span><span class=\"mord\">10</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">2</span><span class=\"mopen\">(</span><span class=\"mord\">10</span><span class=\"mclose\">)</span></span></span></span>。</li>\n<li><code>|</code>符号，<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mi mathvariant=\"normal\">∣</mi><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">x | y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mord\">∣</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>，会将两个十进制数在二进制下进行或运算（都0为0，其余为1） 然后返回其十进制下的值。例如 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>3</mn><mo stretchy=\"false\">(</mo><mn>11</mn><mo stretchy=\"false\">)</mo><mi mathvariant=\"normal\">∣</mi><mn>2</mn><mo stretchy=\"false\">(</mo><mn>10</mn><mo stretchy=\"false\">)</mo><mo>=</mo><mn>3</mn><mo stretchy=\"false\">(</mo><mn>11</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">3(11) | 2(10)=3(11)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">3</span><span class=\"mopen\">(</span><span class=\"mord\">11</span><span class=\"mclose\">)</span><span class=\"mord\">∣2</span><span class=\"mopen\">(</span><span class=\"mord\">10</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">3</span><span class=\"mopen\">(</span><span class=\"mord\">11</span><span class=\"mclose\">)</span></span></span></span>。</li>\n<li><code>^</code>符号，<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mtext> </mtext><mover accent=\"true\"><mrow></mrow><mo>ˆ</mo></mover><mtext> </mtext><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">x \\  \\^{} \\ y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\"> </span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6944em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.25em;\"><span class=\"mord\">ˆ</span></span></span></span></span></span></span><span class=\"mspace\"> </span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>，会将两个十进制数在二进制下进行异或运算（不同为1，其余 为0）然后返回其十进制下的值。例如 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>3</mn><mo stretchy=\"false\">(</mo><mn>11</mn><mo stretchy=\"false\">)</mo><mtext> </mtext><mover accent=\"true\"><mrow></mrow><mo>ˆ</mo></mover><mtext> </mtext><mn>2</mn><mo stretchy=\"false\">(</mo><mn>10</mn><mo stretchy=\"false\">)</mo><mo>=</mo><mn>1</mn><mo stretchy=\"false\">(</mo><mn>01</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">3(11)\\ \\^{} \\ 2(10)=1(01)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">3</span><span class=\"mopen\">(</span><span class=\"mord\">11</span><span class=\"mclose\">)</span><span class=\"mspace\"> </span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6944em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.25em;\"><span class=\"mord\">ˆ</span></span></span></span></span></span></span><span class=\"mspace\"> </span><span class=\"mord\">2</span><span class=\"mopen\">(</span><span class=\"mord\">10</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mopen\">(</span><span class=\"mord\">01</span><span class=\"mclose\">)</span></span></span></span>。</li>\n<li><code>~</code>符号，<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mover accent=\"true\"><mrow></mrow><mo>˜</mo></mover><mtext> </mtext><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">\\~{} \\ x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6679em;\"></span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6679em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.25em;\"><span class=\"mord\">˜</span></span></span></span></span></span></span><span class=\"mspace\"> </span><span class=\"mord mathnormal\">x</span></span></span></span>，按位取反。例如 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mover accent=\"true\"><mrow></mrow><mo>˜</mo></mover><mtext> </mtext><mn>101</mn><mo>=</mo><mn>010</mn></mrow><annotation encoding=\"application/x-tex\">\\~{} \\ 101=010</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6679em;\"></span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6679em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.25em;\"><span class=\"mord\">˜</span></span></span></span></span></span></span><span class=\"mspace\"> </span><span class=\"mord\">101</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">010</span></span></span></span>。</li>\n<li><code>&#x3C;&#x3C;</code>符号，左移操作，<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo>&#x3C;</mo><mo>&#x3C;</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">x&#x3C;&#x3C;2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&#x3C;&#x3C;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span></span></span></span>，将 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span> 在二进制下的每一位向左移动两位，最右边用 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span> 填充，<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo>&#x3C;</mo><mo>&#x3C;</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">x&#x3C;&#x3C;2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&#x3C;&#x3C;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span></span></span></span> 相当于让 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span> <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>×</mo><mn>4</mn></mrow><annotation encoding=\"application/x-tex\">\\times 4</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">×</span><span class=\"mord\">4</span></span></span></span>。</li>\n<li><code>>></code>符号，是右移操作，<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo>></mo><mo>></mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">x>>1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">>></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span> 相当于给 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mi mathvariant=\"normal\">/</mi><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">x/2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mord\">/2</span></span></span></span>，去掉 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span> 二进制下的最右一位</li>\n</ul><ol>\n<li>判断一个数字 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span> 二进制下第 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span> 位是不是等于 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>。（最低第 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span> 位）\n方法：<code>if(((1&#x3C;&#x3C;(i−1))&#x26;x)>0)</code> 将 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span> 左移 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">i-1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7429em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">i</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span> 位，相当于制造了一个只有第 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span> 位上是 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>，其他位上都是 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span> 的二进制数。然后与 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span> 做与运算，如果结果 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>></mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">>0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span class=\"mrel\">></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>， 说明 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span> 第 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span> 位上是 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>，反之则是 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>。</li>\n<li>将 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span> 的第i位更改成 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>。\n方法：<code>x|=(1&#x3C;&#x3C;(i−1))</code>证明方法与 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span> 类似。</li>\n<li>将 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span> 的第 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span> 位更改成<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>。\n方法：<code>x&#x26;=(~(1&#x3C;&#x3C;(i−1)))</code></li>\n<li>将 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span> 最靠右的 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span> 去掉。\n方法：<code>x=x&#x26;(x−1)</code></li>\n<li>取出 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span> 的第 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span> 位。\n方法：<code>(x>>(i-1))&#x26;1</code></li>\n<li>将 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span> 的第 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span> 位取反。\n方法：<code>x^=((1&#x3C;&#x3C;(i-1))</code></li>\n<li>取出 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span> 最靠右的 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>。\n方法：<code>x&#x26;(-x)</code></li>\n<li>判断是否有两个连续的 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>。\n方法：<code>if(x&#x26;(x&#x3C;&#x3C;1))</code></li>\n<li>枚举子集。\n方法：<code>for(int x=sta;x;x=((x-1)&#x26;sta) cout&#x3C;&#x3C;x;</code></li>\n</ol><section><h3 id=\"例题1p1896-scoi2005-互不侵犯\">例题1：<a href=\"https://www.luogu.com.cn/problem/P1896\">P1896 [SCOI2005] 互不侵犯</a><a class=\"anchor\" href=\"#例题1p1896-scoi2005-互不侵犯\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h3><p>在 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi><mo>×</mo><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">N \\times N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span> 的棋盘里面放 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>K</mi></mrow><annotation encoding=\"application/x-tex\">K</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span></span></span></span> 个国王，使他们互不攻击，共有多少种摆放方案。国王能攻击到它上下左右，以及左上左下右上右下八个方向上附近的各一个格子，共 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>8</mn></mrow><annotation encoding=\"application/x-tex\">8</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">8</span></span></span></span> 个格子。\n对于全部数据，<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo>≤</mo><mi>N</mi><mo>≤</mo><mn>9</mn><mtext>，</mtext><mn>0</mn><mo>≤</mo><mi>K</mi><mo>≤</mo><mi>N</mi><mo>×</mo><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">1 \\le N \\le 9，0  \\le K \\le N \\times N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7804em;vertical-align:-0.136em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8193em;vertical-align:-0.136em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8193em;vertical-align:-0.136em;\"></span><span class=\"mord\">9</span><span class=\"mord cjk_fallback\">，</span><span class=\"mord\">0</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8193em;vertical-align:-0.136em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span>。</p><p>首先只考虑一行，此时这一行的国王的状态只与上一行和这一行的国王有关。\n<img src=\"https://oi-wiki.org/dp/images/SCOI2005-%E4%BA%92%E4%B8%8D%E4%BE%B5%E7%8A%AF.png\" alt=\"\">\n以上这个例子中国王的状态可以用二进制表示为 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mn>101001</mn><mrow><mo stretchy=\"false\">(</mo><mn>2</mn><mo stretchy=\"false\">)</mo></mrow></msub></mrow><annotation encoding=\"application/x-tex\">101001_{(2)}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9996em;vertical-align:-0.3552em;\"></span><span class=\"mord\">10100</span><span class=\"mord\"><span class=\"mord\">1</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.5198em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mtight\">2</span><span class=\"mclose mtight\">)</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3552em;\"><span></span></span></span></span></span></span></span></span></span>。\n于是我们有了三个状态：第几行 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span>、此行的状态 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>j</mi></mrow><annotation encoding=\"application/x-tex\">j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span></span></span></span>、已经使用的国王数 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi></mrow><annotation encoding=\"application/x-tex\">s</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">s</span></span></span></span>。\n考虑状态转移。先预处理出每个状态 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi><mi>i</mi><msub><mi>t</mi><mi>x</mi></msub></mrow><annotation encoding=\"application/x-tex\">sit_x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8095em;vertical-align:-0.15em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">i</span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>，其中包含了二进制的 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span> 的个数，及这行放的国王个数 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>c</mi><mi>n</mi><msub><mi>t</mi><mi>x</mi></msub></mrow><annotation encoding=\"application/x-tex\">cnt_x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7651em;vertical-align:-0.15em;\"></span><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\">n</span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>，于是就有状态转移方程：<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>f</mi><mrow><mi>i</mi><mo separator=\"true\">,</mo><mi>j</mi><mo separator=\"true\">,</mo><mi>s</mi></mrow></msub><mo>=</mo><munder><mo>∑</mo><mrow><mn>2</mn><mo>≤</mo><mi>i</mi><mo>≤</mo><mi>n</mi><mo separator=\"true\">,</mo><mn>1</mn><mo>≤</mo><mi>j</mi><mo>≤</mo><mi>t</mi><mi>o</mi><mi>t</mi><mo separator=\"true\">,</mo><mn>1</mn><mo>≤</mo><mi>k</mi><mo>≤</mo><mi>t</mi><mi>o</mi><mi>t</mi></mrow></munder><msub><mi>f</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn><mo separator=\"true\">,</mo><mi>k</mi><mo separator=\"true\">,</mo><mi>s</mi><mo>−</mo><mi>c</mi><mi>n</mi><msub><mi>t</mi><mi>j</mi></msub></mrow></msub></mrow><annotation encoding=\"application/x-tex\">f_{i,j,s} = \\sum \\limits_{2 \\le i \\le n,1 \\le j \\le tot,1 \n\\le k \\le tot} f_{i-1,k,s-cnt_{j}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9805em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\">s</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.8882em;vertical-align:-1.1382em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.75em;\"><span style=\"top:-2.0979em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span><span class=\"mrel mtight\">≤</span><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">≤</span><span class=\"mord mathnormal mtight\">n</span><span class=\"mpunct mtight\">,</span><span class=\"mord mtight\">1</span><span class=\"mrel mtight\">≤</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mrel mtight\">≤</span><span class=\"mord mathnormal mtight\">t</span><span class=\"mord mathnormal mtight\">o</span><span class=\"mord mathnormal mtight\">t</span><span class=\"mpunct mtight\">,</span><span class=\"mord mtight\">1</span><span class=\"mrel mtight\">≤</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mrel mtight\">≤</span><span class=\"mord mathnormal mtight\">t</span><span class=\"mord mathnormal mtight\">o</span><span class=\"mord mathnormal mtight\">t</span></span></span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span><span class=\"mop op-symbol small-op\">∑</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.1382em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\">s</span><span class=\"mbin mtight\">−</span><span class=\"mord mathnormal mtight\">c</span><span class=\"mord mathnormal mtight\">n</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3281em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2819em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3473em;\"><span></span></span></span></span></span></span></span></span></span>。\n接着考虑国王的合法情况，运用位运算来判断两个状态在同一个或相邻位置是否有国王：</p><ul>\n<li><code>if(sit[j]&#x26;sit[k])</code>(上下有重复的国王)</li>\n<li><code>if((sit[j]&#x3C;&#x3C;1)&#x26;sit[k])</code>(左上右下有重复的国王)</li>\n<li><code>if(sit[j]&#x26;(sit[k]&#x3C;&#x3C;1))</code>(右上左下有重复的国王)</li>\n</ul><p>这样就将不符合题意的状态去掉。</p><div class=\"expressive-code\"><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"cpp\" class=\"wrap\" style=\"--ecMaxLine:89ch\"><code><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">1</div></div><div class=\"code\"><span style=\"--0:#F97583;--1:#F97583\">#include</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">&#x3C;bits/stdc++.h></span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">2</div></div><div class=\"code\"><span style=\"--0:#F97583;--1:#F97583\">#define</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#B392F0;--1:#B392F0\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">long</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">long</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">3</div></div><div class=\"code\"><span style=\"--0:#F97583;--1:#F97583\">using</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">namespace</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#B392F0;--1:#B392F0\">std</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">4</div></div><div class=\"code\"><span style=\"--0:#F97583;--1:#F97583\">const</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> N</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">2</span><span style=\"--0:#F97583;--1:#F97583\">e</span><span style=\"--0:#79B8FF;--1:#79B8FF\">3</span><span style=\"--0:#F97583;--1:#F97583\">+</span><span style=\"--0:#79B8FF;--1:#79B8FF\">5</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">5</div></div><div class=\"code\"><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> n,k,f[</span><span style=\"--0:#79B8FF;--1:#79B8FF\">10</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">][N][</span><span style=\"--0:#79B8FF;--1:#79B8FF\">105</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">]</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">{</span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">},sit[N],cnt[N],tot</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,ans</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">6</div></div><div class=\"code\"><span style=\"--0:#F97583;--1:#F97583\">namespace</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#B392F0;--1:#B392F0\">rw</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">{</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">7</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#F97583;--1:#F97583\">inline</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#B392F0;--1:#B392F0\">read</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(){</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">8</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> tot</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,t</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;</span><span style=\"--0:#F97583;--1:#F97583\">char</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> ch</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#B392F0;--1:#B392F0\">getchar</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">();</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">9</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#F97583;--1:#F97583\">while</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(ch</span><span style=\"--0:#F97583;--1:#F97583\">&#x3C;</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">'0'</span><span style=\"--0:#F97583;--1:#F97583\">||</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">ch</span><span style=\"--0:#F97583;--1:#F97583\">></span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">'9'</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">){</span><span style=\"--0:#F97583;--1:#F97583\">if</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(ch</span><span style=\"--0:#F97583;--1:#F97583\">==</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">'-'</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">) t</span><span style=\"--0:#F97583;--1:#F97583\">=-</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;ch</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#B392F0;--1:#B392F0\">getchar</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">();}</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">10</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#F97583;--1:#F97583\">while</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(ch</span><span style=\"--0:#F97583;--1:#F97583\">>=</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">'0'</span><span style=\"--0:#F97583;--1:#F97583\">&#x26;&#x26;</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">ch</span><span style=\"--0:#F97583;--1:#F97583\">&#x3C;=</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">'9'</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">){tot</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">tot</span><span style=\"--0:#F97583;--1:#F97583\">*</span><span style=\"--0:#79B8FF;--1:#79B8FF\">10</span><span style=\"--0:#F97583;--1:#F97583\">+</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">ch</span><span style=\"--0:#F97583;--1:#F97583\">-</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">'0'</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;ch</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#B392F0;--1:#B392F0\">getchar</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">();}</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">11</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#F97583;--1:#F97583\">return</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> tot</span><span style=\"--0:#F97583;--1:#F97583\">*</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">t;</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">12</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">    </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">}</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">13</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#F97583;--1:#F97583\">inline</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">void</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#B392F0;--1:#B392F0\">write</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#FFAB70;--1:#FFAB70\">x</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">){</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">14</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#F97583;--1:#F97583\">if</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(x</span><span style=\"--0:#F97583;--1:#F97583\">&#x3C;</span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">) </span><span style=\"--0:#B392F0;--1:#B392F0\">putchar</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">'-'</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">),x</span><span style=\"--0:#F97583;--1:#F97583\">=-</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">x;</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">15</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#F97583;--1:#F97583\">static</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> sta[</span><span style=\"--0:#79B8FF;--1:#79B8FF\">35</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">];</span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> top</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">16</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#F97583;--1:#F97583\">do</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">{sta[top</span><span style=\"--0:#F97583;--1:#F97583\">++</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">]</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">x</span><span style=\"--0:#F97583;--1:#F97583\">%</span><span style=\"--0:#79B8FF;--1:#79B8FF\">10</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,x</span><span style=\"--0:#F97583;--1:#F97583\">/=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">10</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;}</span><span style=\"--0:#F97583;--1:#F97583\">while</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(x);</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">17</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#F97583;--1:#F97583\">while</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(top) </span><span style=\"--0:#B392F0;--1:#B392F0\">putchar</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(sta[</span><span style=\"--0:#F97583;--1:#F97583\">--</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">top]</span><span style=\"--0:#F97583;--1:#F97583\">+</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">'0'</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">);</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">18</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">    </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">}</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">19</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#F97583;--1:#F97583\">inline</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">void</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#B392F0;--1:#B392F0\">file</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(){</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">20</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#B392F0;--1:#B392F0\">freopen</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">\".in\"</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">\"r\"</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,stdin);</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">21</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#B392F0;--1:#B392F0\">freopen</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">\".out\"</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">\"w\"</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,stdout);</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">22</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">    </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">}</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">23</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#F97583;--1:#F97583\">inline</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">void</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#B392F0;--1:#B392F0\">print</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#F97583;--1:#F97583\">const</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#FFAB70;--1:#FFAB70\">x</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,</span><span style=\"--0:#F97583;--1:#F97583\">const</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">char</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#FFAB70;--1:#FFAB70\">ch</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">){</span><span style=\"--0:#F97583;--1:#F97583\">return</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> (</span><span style=\"--0:#B392F0;--1:#B392F0\">write</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(x),</span><span style=\"--0:#B392F0;--1:#B392F0\">putchar</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(ch)),</span><span style=\"--0:#F97583;--1:#F97583\">void</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">);}</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">24</div></div><div class=\"code\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">}</span><span style=\"--0:#F97583;--1:#F97583\">using</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">namespace</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#B392F0;--1:#B392F0\">rw</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">25</div></div><div class=\"code\"><span style=\"--0:#F97583;--1:#F97583\">inline</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">void</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#B392F0;--1:#B392F0\">dfs</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#F97583;--1:#F97583\">const</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#FFAB70;--1:#FFAB70\">h</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,</span><span style=\"--0:#F97583;--1:#F97583\">const</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#FFAB70;--1:#FFAB70\">sum</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,</span><span style=\"--0:#F97583;--1:#F97583\">const</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#FFAB70;--1:#FFAB70\">step</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">){</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">26</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#F97583;--1:#F97583\">if</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(step</span><span style=\"--0:#F97583;--1:#F97583\">>=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">n){</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">27</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">        </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">sit[</span><span style=\"--0:#F97583;--1:#F97583\">++</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">tot]</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">h;</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">28</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">        </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">cnt[tot]</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">sum;</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">29</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#F97583;--1:#F97583\">return</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">30</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">    </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">}</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">31</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#B392F0;--1:#B392F0\">dfs</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(h,sum,step</span><span style=\"--0:#F97583;--1:#F97583\">+</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">);</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">32</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#B392F0;--1:#B392F0\">dfs</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(h</span><span style=\"--0:#F97583;--1:#F97583\">+</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#F97583;--1:#F97583\">&#x3C;&#x3C;</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">step),sum</span><span style=\"--0:#F97583;--1:#F97583\">+</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,step</span><span style=\"--0:#F97583;--1:#F97583\">+</span><span style=\"--0:#79B8FF;--1:#79B8FF\">2</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">);</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">33</div></div><div class=\"code\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">}</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">34</div></div><div class=\"code\"><span style=\"--0:#F97583;--1:#F97583\">signed</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#B392F0;--1:#B392F0\">main</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(){</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">35</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">    </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">n</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#B392F0;--1:#B392F0\">read</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(),k</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#B392F0;--1:#B392F0\">read</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">();</span><span style=\"--0:#B392F0;--1:#B392F0\">dfs</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,</span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,</span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">);</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">36</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#F97583;--1:#F97583\">for</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> i</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;i</span><span style=\"--0:#F97583;--1:#F97583\">&#x3C;=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">tot;i</span><span style=\"--0:#F97583;--1:#F97583\">++</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">) f[</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">][i][cnt[i]]</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">37</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#F97583;--1:#F97583\">for</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> i</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">2</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;i</span><span style=\"--0:#F97583;--1:#F97583\">&#x3C;=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">n;i</span><span style=\"--0:#F97583;--1:#F97583\">++</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">){</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">38</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#F97583;--1:#F97583\">for</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> j</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;j</span><span style=\"--0:#F97583;--1:#F97583\">&#x3C;=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">tot;j</span><span style=\"--0:#F97583;--1:#F97583\">++</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">){</span></div></div><div class=\"ec-line\" style=\"--ecIndent:12ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">39</div></div><div class=\"code\"><span class=\"indent\">            </span><span style=\"--0:#F97583;--1:#F97583\">for</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> l</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;l</span><span style=\"--0:#F97583;--1:#F97583\">&#x3C;=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">tot;l</span><span style=\"--0:#F97583;--1:#F97583\">++</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">){</span></div></div><div class=\"ec-line\" style=\"--ecIndent:16ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">40</div></div><div class=\"code\"><span class=\"indent\">                </span><span style=\"--0:#F97583;--1:#F97583\">if</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">((sit[j]</span><span style=\"--0:#F97583;--1:#F97583\">&#x26;</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">sit[l])</span><span style=\"--0:#F97583;--1:#F97583\">||</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">((sit[j]</span><span style=\"--0:#F97583;--1:#F97583\">&#x3C;&#x3C;</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">)</span><span style=\"--0:#F97583;--1:#F97583\">&#x26;</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">sit[l])</span><span style=\"--0:#F97583;--1:#F97583\">||</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(sit[j]</span><span style=\"--0:#F97583;--1:#F97583\">&#x26;</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(sit[l]</span><span style=\"--0:#F97583;--1:#F97583\">&#x3C;&#x3C;</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">))) </span><span style=\"--0:#F97583;--1:#F97583\">continue</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;</span></div></div><div class=\"ec-line\" style=\"--ecIndent:16ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">41</div></div><div class=\"code\"><span class=\"indent\">                </span><span style=\"--0:#F97583;--1:#F97583\">for</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> s</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">k;s</span><span style=\"--0:#F97583;--1:#F97583\">>=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">cnt[j];s</span><span style=\"--0:#F97583;--1:#F97583\">--</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">) f[i][j][s]</span><span style=\"--0:#F97583;--1:#F97583\">+=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">f[i</span><span style=\"--0:#F97583;--1:#F97583\">-</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">][l][s</span><span style=\"--0:#F97583;--1:#F97583\">-</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">cnt[j]];</span></div></div><div class=\"ec-line\" style=\"--ecIndent:12ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">42</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">            </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">}</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">43</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">        </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">}</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">44</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">    </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">}</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">45</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#F97583;--1:#F97583\">for</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> i</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;i</span><span style=\"--0:#F97583;--1:#F97583\">&#x3C;=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">tot;i</span><span style=\"--0:#F97583;--1:#F97583\">++</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">) ans</span><span style=\"--0:#F97583;--1:#F97583\">+=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">f[n][i][k];</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">46</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#B392F0;--1:#B392F0\">print</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(ans,</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">'</span><span style=\"--0:#79B8FF;--1:#79B8FF\">\\n</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">'</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">);</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">47</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#F97583;--1:#F97583\">return</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">48</div></div><div class=\"code\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">}</span></div></div></code><button class=\"copy-btn\" aria-label=\"Copy code\"><div class=\"copy-btn-icon\"><svg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon copy-icon\"><path d=\"M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z\"></path></svg><svg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon success-icon\"><path d=\"m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z\"></path></svg></div></button></pre></figure></div></section><section><h3 id=\"例题2p3959-noip-2017-提高组-宝藏\">例题2：<a href=\"https://www.luogu.com.cn/problem/P3959\">P3959 [NOIP 2017 提高组] 宝藏</a><a class=\"anchor\" href=\"#例题2p3959-noip-2017-提高组-宝藏\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h3><p>题面详见原题。</p></section><section><h3 id=\"例题3cf1767e-algebra-flash\">例题3：<a href=\"https://www.luogu.com.cn/problem/CF1767E\">CF1767E</a> <a href=\"https://codeforces.com/problemset/problem/1767/E\">Algebra Flash</a><a class=\"anchor\" href=\"#例题3cf1767e-algebra-flash\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h3><p>给出⼀个 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>≤</mo><mn>40</mn></mrow><annotation encoding=\"application/x-tex\">n \\le 40</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7719em;vertical-align:-0.136em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">40</span></span></span></span> 个点的图，每个点有权值，求其最大权独立集。</p><hr></section></section>\n<section><h1 id=\"数位-dptextdpdp\">数位 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>DP</mtext></mrow><annotation encoding=\"application/x-tex\">\\text{DP}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord text\"><span class=\"mord\">DP</span></span></span></span></span><a class=\"anchor\" href=\"#数位-dptextdpdp\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h1><p>此类问题的特征比较明显，常见的形式是数 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mi>l</mi><mo separator=\"true\">,</mo><mi>r</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[l,r]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mclose\">]</span></span></span></span> 内满足某个条件的数字个数，这个数字可能很大。</p><p>考虑人类计数的⽅式，最朴素的计数就是从小到大开始依次加⼀。但我们发现对于位数比较多的数，这样的过程中有许多重复的部分。\n例如，从 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>7000</mn></mrow><annotation encoding=\"application/x-tex\">7000</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">7000</span></span></span></span> 数到 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>7999</mn></mrow><annotation encoding=\"application/x-tex\">7999</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">7999</span></span></span></span> 从 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>8000</mn></mrow><annotation encoding=\"application/x-tex\">8000</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">8000</span></span></span></span> 数到 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>8999</mn></mrow><annotation encoding=\"application/x-tex\">8999</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">8999</span></span></span></span>、和从 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>9000</mn></mrow><annotation encoding=\"application/x-tex\">9000</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">9000</span></span></span></span> 数到 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>9999</mn></mrow><annotation encoding=\"application/x-tex\">9999</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">9999</span></span></span></span> 的过程⾮常相似，它们都是后三位从 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>000</mn></mrow><annotation encoding=\"application/x-tex\">000</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">000</span></span></span></span> 变到 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>999</mn></mrow><annotation encoding=\"application/x-tex\">999</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">999</span></span></span></span>，不⼀样的地⽅只有千位这⼀位，所以我们可以把这些过程合并起来，⽤ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>DP</mtext></mrow><annotation encoding=\"application/x-tex\">\\text{DP}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord text\"><span class=\"mord\">DP</span></span></span></span></span> 的⽅式进⾏状态转移。</p><p>我们可以用 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><mi>n</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">f ( n )</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">)</span></span></span></span> 表示 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mn>0</mn><mo separator=\"true\">,</mo><mi>n</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[ 0 , n ]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">]</span></span></span></span> 的所有满足条件的个数，那么对于 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mi>l</mi><mo separator=\"true\">,</mo><mi>r</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[ l , r ]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mclose\">]</span></span></span></span> 我们就可以用 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mi>l</mi><mo separator=\"true\">,</mo><mi>r</mi><mo stretchy=\"false\">]</mo><mtext>  </mtext><mo>⟺</mo><mtext>  </mtext><mi>f</mi><mo stretchy=\"false\">(</mo><mi>r</mi><mo stretchy=\"false\">)</mo><mo>−</mo><mi>f</mi><mo stretchy=\"false\">(</mo><mi>l</mi><mo>−</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">[ l , r ] \\iff f ( r ) − f ( l − 1 )</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">⟺</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span></span>，前缀和思想。那么也就是说我们只要求出 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><mi>n</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">f ( n )</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">)</span></span></span></span> 即可。那么数位 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>DP</mtext></mrow><annotation encoding=\"application/x-tex\">\\text{DP}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord text\"><span class=\"mord\">DP</span></span></span></span></span> 关键的思想就是从树的角度来考虑。将数拆分成位，从高位到低位开始枚举。我们可以视 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span> 为 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span> 位数，那么我们拆分<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi><mo>:</mo><msub><mi>a</mi><mi>n</mi></msub><mtext>、</mtext><msub><mi>a</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><msub><mi>a</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">N:a_{n}、a_{n-1}...a_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">:</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8917em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord cjk_fallback\">、</span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span><span class=\"mord\">...</span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>。那么我们就可以开始分解建树，如下。之后我们就可以预处理再求解 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><mi>n</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">f ( n )</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">)</span></span></span></span> 了。\n<img src=\"https://i-blog.csdnimg.cn/blog_migrate/e4e4bdb49dde528bc9e22713b7fde44a.png\" alt=\"\"></p><section><h3 id=\"例题1p2602-zjoi2010-数字计数\">例题1：<a href=\"https://www.luogu.com.cn/problem/P2602\">P2602 [ZJOI2010] 数字计数</a><a class=\"anchor\" href=\"#例题1p2602-zjoi2010-数字计数\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h3><p>给定两个正整数 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi></mrow><annotation encoding=\"application/x-tex\">a</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">a</span></span></span></span> 和 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>b</mi></mrow><annotation encoding=\"application/x-tex\">b</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">b</span></span></span></span>，求在 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mi>a</mi><mo separator=\"true\">,</mo><mi>b</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[a,b]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">a</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">b</span><span class=\"mclose\">]</span></span></span></span> 中的所有整数中，每个数码各出现了多少次。\n对于 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>100</mn><mi mathvariant=\"normal\">%</mi></mrow><annotation encoding=\"application/x-tex\">100 \\%</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8056em;vertical-align:-0.0556em;\"></span><span class=\"mord\">100%</span></span></span></span> 的数据，保证 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo>≤</mo><mi>a</mi><mo>≤</mo><mi>b</mi><mo>≤</mo><msup><mn>10</mn><mn>12</mn></msup></mrow><annotation encoding=\"application/x-tex\">1 \\le a \\le b \\le 10^{12}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7804em;vertical-align:-0.136em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7719em;vertical-align:-0.136em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8304em;vertical-align:-0.136em;\"></span><span class=\"mord mathnormal\">b</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">12</span></span></span></span></span></span></span></span></span></span></span></span>。</p><p>首先差分⼀下，变成求解 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mn>1</mn><mo separator=\"true\">,</mo><mi>r</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[1,r]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mclose\">]</span></span></span></span> 的答案。\n发现唯⼀的⼀个问题是前导零和当前是否顶着 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>r</mi></mrow><annotation encoding=\"application/x-tex\">r</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span></span></span></span> 的上界，记录这两者即可。常见的实现方法是记忆化搜索。</p><div class=\"expressive-code\"><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"cpp\" class=\"wrap\" style=\"--ecMaxLine:88ch\"><code><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">1</div></div><div class=\"code\"><span style=\"--0:#F97583;--1:#F97583\">#include</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">&#x3C;bits/stdc++.h></span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">2</div></div><div class=\"code\"><span style=\"--0:#F97583;--1:#F97583\">#define</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#B392F0;--1:#B392F0\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">long</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">long</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">3</div></div><div class=\"code\"><span style=\"--0:#F97583;--1:#F97583\">using</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">namespace</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#B392F0;--1:#B392F0\">std</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">4</div></div><div class=\"code\"><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> f[</span><span style=\"--0:#79B8FF;--1:#79B8FF\">20</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">][</span><span style=\"--0:#79B8FF;--1:#79B8FF\">20</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">],num[</span><span style=\"--0:#79B8FF;--1:#79B8FF\">20</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">],a,b;</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">5</div></div><div class=\"code\"><span style=\"--0:#F97583;--1:#F97583\">namespace</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#B392F0;--1:#B392F0\">rw</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">{</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">6</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#F97583;--1:#F97583\">inline</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#B392F0;--1:#B392F0\">read</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(){</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">7</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> tot</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,t</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;</span><span style=\"--0:#F97583;--1:#F97583\">char</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> ch</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#B392F0;--1:#B392F0\">getchar</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">();</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">8</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#F97583;--1:#F97583\">while</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(ch</span><span style=\"--0:#F97583;--1:#F97583\">&#x3C;</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">'0'</span><span style=\"--0:#F97583;--1:#F97583\">||</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">ch</span><span style=\"--0:#F97583;--1:#F97583\">></span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">'9'</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">){</span><span style=\"--0:#F97583;--1:#F97583\">if</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(ch</span><span style=\"--0:#F97583;--1:#F97583\">==</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">'-'</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">) t</span><span style=\"--0:#F97583;--1:#F97583\">=-</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;ch</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#B392F0;--1:#B392F0\">getchar</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">();}</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">9</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#F97583;--1:#F97583\">while</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(ch</span><span style=\"--0:#F97583;--1:#F97583\">>=</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">'0'</span><span style=\"--0:#F97583;--1:#F97583\">&#x26;&#x26;</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">ch</span><span style=\"--0:#F97583;--1:#F97583\">&#x3C;=</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">'9'</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">){tot</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">tot</span><span style=\"--0:#F97583;--1:#F97583\">*</span><span style=\"--0:#79B8FF;--1:#79B8FF\">10</span><span style=\"--0:#F97583;--1:#F97583\">+</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">ch</span><span style=\"--0:#F97583;--1:#F97583\">-</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">'0'</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;ch</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#B392F0;--1:#B392F0\">getchar</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">();}</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">10</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#F97583;--1:#F97583\">return</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> tot</span><span style=\"--0:#F97583;--1:#F97583\">*</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">t;</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">11</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">    </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">}</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">12</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#F97583;--1:#F97583\">inline</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">void</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#B392F0;--1:#B392F0\">write</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#FFAB70;--1:#FFAB70\">x</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">){</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">13</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#F97583;--1:#F97583\">if</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(x</span><span style=\"--0:#F97583;--1:#F97583\">&#x3C;</span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">) </span><span style=\"--0:#B392F0;--1:#B392F0\">putchar</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">'-'</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">),x</span><span style=\"--0:#F97583;--1:#F97583\">=-</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">x;</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">14</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#F97583;--1:#F97583\">static</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> sta[</span><span style=\"--0:#79B8FF;--1:#79B8FF\">35</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">];</span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> top</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">15</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#F97583;--1:#F97583\">do</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">{sta[top</span><span style=\"--0:#F97583;--1:#F97583\">++</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">]</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">x</span><span style=\"--0:#F97583;--1:#F97583\">%</span><span style=\"--0:#79B8FF;--1:#79B8FF\">10</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,x</span><span style=\"--0:#F97583;--1:#F97583\">/=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">10</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;}</span><span style=\"--0:#F97583;--1:#F97583\">while</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(x);</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">16</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#F97583;--1:#F97583\">while</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(top) </span><span style=\"--0:#B392F0;--1:#B392F0\">putchar</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(sta[</span><span style=\"--0:#F97583;--1:#F97583\">--</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">top]</span><span style=\"--0:#F97583;--1:#F97583\">+</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">'0'</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">);</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">17</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">    </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">}</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">18</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#F97583;--1:#F97583\">inline</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">void</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#B392F0;--1:#B392F0\">file</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(){</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">19</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#B392F0;--1:#B392F0\">freopen</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">\".in\"</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">\"r\"</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,stdin);</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">20</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#B392F0;--1:#B392F0\">freopen</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">\".out\"</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">\"w\"</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,stdout);</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">21</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">    </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">}</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">22</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#F97583;--1:#F97583\">inline</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">void</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#B392F0;--1:#B392F0\">print</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#F97583;--1:#F97583\">const</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#FFAB70;--1:#FFAB70\">x</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,</span><span style=\"--0:#F97583;--1:#F97583\">const</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">char</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#FFAB70;--1:#FFAB70\">ch</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">){</span><span style=\"--0:#F97583;--1:#F97583\">return</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> (</span><span style=\"--0:#B392F0;--1:#B392F0\">write</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(x),</span><span style=\"--0:#B392F0;--1:#B392F0\">putchar</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(ch)),</span><span style=\"--0:#F97583;--1:#F97583\">void</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">);}</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">23</div></div><div class=\"code\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">}</span><span style=\"--0:#F97583;--1:#F97583\">using</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">namespace</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#B392F0;--1:#B392F0\">rw</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">24</div></div><div class=\"code\"><span style=\"--0:#F97583;--1:#F97583\">inline</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#B392F0;--1:#B392F0\">dp</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#F97583;--1:#F97583\">const</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#FFAB70;--1:#FFAB70\">pos</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,</span><span style=\"--0:#F97583;--1:#F97583\">const</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#FFAB70;--1:#FFAB70\">flag</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,</span><span style=\"--0:#F97583;--1:#F97583\">const</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#FFAB70;--1:#FFAB70\">sum</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,</span><span style=\"--0:#F97583;--1:#F97583\">const</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#FFAB70;--1:#FFAB70\">d</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,</span><span style=\"--0:#F97583;--1:#F97583\">const</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#FFAB70;--1:#FFAB70\">qdl</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">){</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">25</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> res</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,up</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">9</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;</span><span style=\"--0:#99A0A6;--1:#99A0A6\">//flag为1表示有限制，lead为0表示有前导0</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">26</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#F97583;--1:#F97583\">if</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(pos</span><span style=\"--0:#F97583;--1:#F97583\">==</span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">) </span><span style=\"--0:#F97583;--1:#F97583\">return</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> sum;</span><span style=\"--0:#99A0A6;--1:#99A0A6\">//边界条件</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">27</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#F97583;--1:#F97583\">if</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#F97583;--1:#F97583\">!</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">flag</span><span style=\"--0:#F97583;--1:#F97583\">&#x26;&#x26;</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">qdl</span><span style=\"--0:#F97583;--1:#F97583\">&#x26;&#x26;</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">f[pos][sum]</span><span style=\"--0:#F97583;--1:#F97583\">!=-</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">) </span><span style=\"--0:#F97583;--1:#F97583\">return</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> f[pos][sum];</span><span style=\"--0:#99A0A6;--1:#99A0A6\">//记忆化</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">28</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#F97583;--1:#F97583\">if</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(flag) up</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">num[pos];</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">29</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#F97583;--1:#F97583\">for</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> i</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;i</span><span style=\"--0:#F97583;--1:#F97583\">&#x3C;=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">up;i</span><span style=\"--0:#F97583;--1:#F97583\">++</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">){</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">30</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">        </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">res</span><span style=\"--0:#F97583;--1:#F97583\">+=</span><span style=\"--0:#B392F0;--1:#B392F0\">dp</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(pos</span><span style=\"--0:#F97583;--1:#F97583\">-</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,(i</span><span style=\"--0:#F97583;--1:#F97583\">==</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">up</span><span style=\"--0:#F97583;--1:#F97583\">&#x26;&#x26;</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">flag),sum</span><span style=\"--0:#F97583;--1:#F97583\">+</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">((i</span><span style=\"--0:#F97583;--1:#F97583\">||</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">qdl)</span><span style=\"--0:#F97583;--1:#F97583\">&#x26;&#x26;</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(i</span><span style=\"--0:#F97583;--1:#F97583\">==</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">d)),d,qdl</span><span style=\"--0:#F97583;--1:#F97583\">||</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">i);</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">31</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">    </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">}</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">32</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#F97583;--1:#F97583\">if</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#F97583;--1:#F97583\">!</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">flag</span><span style=\"--0:#F97583;--1:#F97583\">&#x26;&#x26;</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">qdl) f[pos][sum]</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">res;</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">33</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#F97583;--1:#F97583\">return</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> res;</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">34</div></div><div class=\"code\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">}</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">35</div></div><div class=\"code\"><span style=\"--0:#F97583;--1:#F97583\">inline</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#B392F0;--1:#B392F0\">solve</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#FFAB70;--1:#FFAB70\">x</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,</span><span style=\"--0:#F97583;--1:#F97583\">const</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#FFAB70;--1:#FFAB70\">d</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">){</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">36</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#B392F0;--1:#B392F0\">memset</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(f,</span><span style=\"--0:#F97583;--1:#F97583\">-</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,</span><span style=\"--0:#F97583;--1:#F97583\">sizeof</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(f));</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">37</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> len</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">38</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#F97583;--1:#F97583\">while</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(x){</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">39</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">        </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">num[</span><span style=\"--0:#F97583;--1:#F97583\">++</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">len]</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">x</span><span style=\"--0:#F97583;--1:#F97583\">%</span><span style=\"--0:#79B8FF;--1:#79B8FF\">10</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;</span><span style=\"--0:#99A0A6;--1:#99A0A6\">//最高位在第一位</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">40</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">        </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">x</span><span style=\"--0:#F97583;--1:#F97583\">/=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">10</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">41</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">    </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">}</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">42</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#F97583;--1:#F97583\">return</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#B392F0;--1:#B392F0\">dp</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(len,</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,</span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,d,</span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">);</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">43</div></div><div class=\"code\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">}</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">44</div></div><div class=\"code\"><span style=\"--0:#F97583;--1:#F97583\">signed</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#B392F0;--1:#B392F0\">main</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(){</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">45</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">    </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">a</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#B392F0;--1:#B392F0\">read</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(),b</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#B392F0;--1:#B392F0\">read</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">();</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">46</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#F97583;--1:#F97583\">for</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> i</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;i</span><span style=\"--0:#F97583;--1:#F97583\">&#x3C;=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">9</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;i</span><span style=\"--0:#F97583;--1:#F97583\">++</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">) </span><span style=\"--0:#B392F0;--1:#B392F0\">print</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#B392F0;--1:#B392F0\">solve</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(b,i)</span><span style=\"--0:#F97583;--1:#F97583\">-</span><span style=\"--0:#B392F0;--1:#B392F0\">solve</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(a</span><span style=\"--0:#F97583;--1:#F97583\">-</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,i),</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">' '</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">);</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">47</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#F97583;--1:#F97583\">return</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">48</div></div><div class=\"code\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">}</span></div></div></code><button class=\"copy-btn\" aria-label=\"Copy code\"><div class=\"copy-btn-icon\"><svg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon copy-icon\"><path d=\"M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z\"></path></svg><svg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon success-icon\"><path d=\"m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z\"></path></svg></div></button></pre></figure></div><hr></section></section>\n<section><h1 id=\"概率-dptextdpdp-和期望-dptextdpdp\">概率 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>DP</mtext></mrow><annotation encoding=\"application/x-tex\">\\text{DP}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord text\"><span class=\"mord\">DP</span></span></span></span></span> 和期望 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>DP</mtext></mrow><annotation encoding=\"application/x-tex\">\\text{DP}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord text\"><span class=\"mord\">DP</span></span></span></span></span><a class=\"anchor\" href=\"#概率-dptextdpdp-和期望-dptextdpdp\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h1><p>前置知识：概率和期望，高斯消元法。\n由于概率和期望联系紧密，且常常以期望 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>DP</mtext></mrow><annotation encoding=\"application/x-tex\">\\text{DP}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord text\"><span class=\"mord\">DP</span></span></span></span></span> 的形式出现，所以下面会多讲⼀点期望相关。虽然随机变量的期望在大纲中是超纲的，但是平时运用还是非常广泛的。</p><section><h2 id=\"概率-dptextdpdp\">概率 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>DP</mtext></mrow><annotation encoding=\"application/x-tex\">\\text{DP}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord text\"><span class=\"mord\">DP</span></span></span></span></span><a class=\"anchor\" href=\"#概率-dptextdpdp\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h2><p>这类题目采用顺推，也就是从初始状态推向结果。\n和⼀般的 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>DP</mtext></mrow><annotation encoding=\"application/x-tex\">\\text{DP}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord text\"><span class=\"mord\">DP</span></span></span></span></span> 类似，难点依然是对状态转移方程的刻画，只是这类题目经过了概率论知识的包装。</p><section><h3 id=\"例题cf148d-bag-of-mice\">例题：<a href=\"https://codeforces.com/problemset/problem/148/D\">CF148D</a> <a href=\"https://www.luogu.com.cn/problem/CF148D\">Bag of mice</a><a class=\"anchor\" href=\"#例题cf148d-bag-of-mice\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h3><p>袋子里有 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>w</mi></mrow><annotation encoding=\"application/x-tex\">w</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span></span></span></span> 只白鼠和 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>b</mi></mrow><annotation encoding=\"application/x-tex\">b</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">b</span></span></span></span> 只黑鼠 ，<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi></mrow><annotation encoding=\"application/x-tex\">A</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">A</span></span></span></span> 和 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>B</mi></mrow><annotation encoding=\"application/x-tex\">B</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span></span></span></span> 轮流从袋子里抓，谁先抓到白色谁就赢。<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi></mrow><annotation encoding=\"application/x-tex\">A</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">A</span></span></span></span> 每次随机抓一只，<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>B</mi></mrow><annotation encoding=\"application/x-tex\">B</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span></span></span></span> 每次随机抓完一只之后会有另一只随机老鼠跑出来。如果两个人都没有抓到白色则 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>B</mi></mrow><annotation encoding=\"application/x-tex\">B</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span></span></span></span> 赢。<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi></mrow><annotation encoding=\"application/x-tex\">A</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">A</span></span></span></span> 先抓，问 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi></mrow><annotation encoding=\"application/x-tex\">A</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">A</span></span></span></span> 赢的概率。\n范围：<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn><mo>≤</mo><mi>w</mi><mo separator=\"true\">,</mo><mi>b</mi><mo>≤</mo><mn>1000</mn></mrow><annotation encoding=\"application/x-tex\">0 \\le w ,b \\le 1000</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7804em;vertical-align:-0.136em;\"></span><span class=\"mord\">0</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">b</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1000</span></span></span></span>。</p><p>设 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>f</mi><mrow><mi>i</mi><mo separator=\"true\">,</mo><mi>j</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">f_{i,j}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9805em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span> 表示当前有 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span> 只白鼠，<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>j</mi></mrow><annotation encoding=\"application/x-tex\">j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span></span></span></span> 只黑鼠时 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi></mrow><annotation encoding=\"application/x-tex\">A</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">A</span></span></span></span> 的获胜概率。\n考虑一论中的情况：</p><ul>\n<li>先手摸到白鼠，直接获胜。</li>\n<li>先手摸到黑鼠，后手摸到白鼠，直接失败。</li>\n<li>先手摸到黑鼠，后手摸到黑鼠，跑出白鼠。通过 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>f</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn><mo separator=\"true\">,</mo><mi>j</mi><mo>−</mo><mn>2</mn></mrow></msub></mrow><annotation encoding=\"application/x-tex\">f_{i-1,j-2}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9805em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">2</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span> 转移。</li>\n<li>先手摸到黑鼠，后手摸到黑鼠，跑出黑鼠。通过 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>f</mi><mrow><mi>i</mi><mo separator=\"true\">,</mo><mi>j</mi><mo>−</mo><mn>3</mn></mrow></msub></mrow><annotation encoding=\"application/x-tex\">f_{i,j-3}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9805em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">3</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span> 转移。</li>\n</ul><div class=\"expressive-code\"><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"cpp\" class=\"wrap\" style=\"--ecMaxLine:88ch\"><code><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">1</div></div><div class=\"code\"><span style=\"--0:#F97583;--1:#F97583\">#include</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">&#x3C;bits/stdc++.h></span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">2</div></div><div class=\"code\"><span style=\"--0:#F97583;--1:#F97583\">#define</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#B392F0;--1:#B392F0\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">long</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">long</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">3</div></div><div class=\"code\"><span style=\"--0:#F97583;--1:#F97583\">using</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">namespace</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#B392F0;--1:#B392F0\">std</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">4</div></div><div class=\"code\"><span style=\"--0:#F97583;--1:#F97583\">const</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> N</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1005</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">5</div></div><div class=\"code\"><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> w,b;</span><span style=\"--0:#F97583;--1:#F97583\">double</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> f[N][N];</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">6</div></div><div class=\"code\"><span style=\"--0:#F97583;--1:#F97583\">namespace</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#B392F0;--1:#B392F0\">rw</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">{</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">7</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#F97583;--1:#F97583\">inline</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#B392F0;--1:#B392F0\">read</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(){</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">8</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> tot</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,t</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;</span><span style=\"--0:#F97583;--1:#F97583\">char</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> ch</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#B392F0;--1:#B392F0\">getchar</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">();</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">9</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#F97583;--1:#F97583\">while</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(ch</span><span style=\"--0:#F97583;--1:#F97583\">&#x3C;</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">'0'</span><span style=\"--0:#F97583;--1:#F97583\">||</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">ch</span><span style=\"--0:#F97583;--1:#F97583\">></span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">'9'</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">){</span><span style=\"--0:#F97583;--1:#F97583\">if</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(ch</span><span style=\"--0:#F97583;--1:#F97583\">==</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">'-'</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">) t</span><span style=\"--0:#F97583;--1:#F97583\">=-</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;ch</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#B392F0;--1:#B392F0\">getchar</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">();}</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">10</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#F97583;--1:#F97583\">while</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(ch</span><span style=\"--0:#F97583;--1:#F97583\">>=</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">'0'</span><span style=\"--0:#F97583;--1:#F97583\">&#x26;&#x26;</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">ch</span><span style=\"--0:#F97583;--1:#F97583\">&#x3C;=</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">'9'</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">){tot</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">tot</span><span style=\"--0:#F97583;--1:#F97583\">*</span><span style=\"--0:#79B8FF;--1:#79B8FF\">10</span><span style=\"--0:#F97583;--1:#F97583\">+</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">ch</span><span style=\"--0:#F97583;--1:#F97583\">-</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">'0'</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;ch</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#B392F0;--1:#B392F0\">getchar</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">();}</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">11</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#F97583;--1:#F97583\">return</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> tot</span><span style=\"--0:#F97583;--1:#F97583\">*</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">t;</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">12</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">    </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">}</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">13</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#F97583;--1:#F97583\">inline</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">void</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#B392F0;--1:#B392F0\">write</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#FFAB70;--1:#FFAB70\">x</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">){</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">14</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#F97583;--1:#F97583\">if</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(x</span><span style=\"--0:#F97583;--1:#F97583\">&#x3C;</span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">) </span><span style=\"--0:#B392F0;--1:#B392F0\">putchar</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">'-'</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">),x</span><span style=\"--0:#F97583;--1:#F97583\">=-</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">x;</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">15</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#F97583;--1:#F97583\">static</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> sta[</span><span style=\"--0:#79B8FF;--1:#79B8FF\">35</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">];</span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> top</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">16</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#F97583;--1:#F97583\">do</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">{sta[top</span><span style=\"--0:#F97583;--1:#F97583\">++</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">]</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">x</span><span style=\"--0:#F97583;--1:#F97583\">%</span><span style=\"--0:#79B8FF;--1:#79B8FF\">10</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,x</span><span style=\"--0:#F97583;--1:#F97583\">/=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">10</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;}</span><span style=\"--0:#F97583;--1:#F97583\">while</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(x);</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">17</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#F97583;--1:#F97583\">while</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(top) </span><span style=\"--0:#B392F0;--1:#B392F0\">putchar</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(sta[</span><span style=\"--0:#F97583;--1:#F97583\">--</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">top]</span><span style=\"--0:#F97583;--1:#F97583\">+</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">'0'</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">);</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">18</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">    </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">}</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">19</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#F97583;--1:#F97583\">inline</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">void</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#B392F0;--1:#B392F0\">file</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(){</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">20</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#B392F0;--1:#B392F0\">freopen</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">\".in\"</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">\"r\"</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,stdin);</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">21</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#B392F0;--1:#B392F0\">freopen</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">\".out\"</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">\"w\"</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,stdout);</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">22</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">    </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">}</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">23</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#F97583;--1:#F97583\">inline</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">void</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#B392F0;--1:#B392F0\">print</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#F97583;--1:#F97583\">const</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#FFAB70;--1:#FFAB70\">x</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,</span><span style=\"--0:#F97583;--1:#F97583\">const</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">char</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#FFAB70;--1:#FFAB70\">ch</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">){</span><span style=\"--0:#F97583;--1:#F97583\">return</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> (</span><span style=\"--0:#B392F0;--1:#B392F0\">write</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(x),</span><span style=\"--0:#B392F0;--1:#B392F0\">putchar</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(ch)),</span><span style=\"--0:#F97583;--1:#F97583\">void</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">);}</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">24</div></div><div class=\"code\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">}</span><span style=\"--0:#F97583;--1:#F97583\">using</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">namespace</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#B392F0;--1:#B392F0\">rw</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">25</div></div><div class=\"code\"><span style=\"--0:#F97583;--1:#F97583\">signed</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#B392F0;--1:#B392F0\">main</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(){</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">26</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">    </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">w</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#B392F0;--1:#B392F0\">read</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(),b</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#B392F0;--1:#B392F0\">read</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">();</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">27</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#F97583;--1:#F97583\">for</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> i</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;i</span><span style=\"--0:#F97583;--1:#F97583\">&#x3C;=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">w;i</span><span style=\"--0:#F97583;--1:#F97583\">++</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">) f[i][</span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">]</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1.0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,f[i][</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">]</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1.0</span><span style=\"--0:#F97583;--1:#F97583\">*</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">i</span><span style=\"--0:#F97583;--1:#F97583\">/</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(i</span><span style=\"--0:#F97583;--1:#F97583\">+</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">);</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">28</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#F97583;--1:#F97583\">if</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#F97583;--1:#F97583\">!</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">b</span><span style=\"--0:#F97583;--1:#F97583\">||</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">b</span><span style=\"--0:#F97583;--1:#F97583\">==</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">) </span><span style=\"--0:#F97583;--1:#F97583\">return</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> cout</span><span style=\"--0:#F97583;--1:#F97583\">&#x3C;&#x3C;</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">fixed</span><span style=\"--0:#F97583;--1:#F97583\">&#x3C;&#x3C;</span><span style=\"--0:#B392F0;--1:#B392F0\">setprecision</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#79B8FF;--1:#79B8FF\">9</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">)</span><span style=\"--0:#F97583;--1:#F97583\">&#x3C;&#x3C;</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">f[w][b]</span><span style=\"--0:#F97583;--1:#F97583\">&#x3C;&#x3C;</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">'</span><span style=\"--0:#79B8FF;--1:#79B8FF\">\\n</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">'</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,</span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">29</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#F97583;--1:#F97583\">for</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> i</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;i</span><span style=\"--0:#F97583;--1:#F97583\">&#x3C;=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">w;i</span><span style=\"--0:#F97583;--1:#F97583\">++</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">){</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">30</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#F97583;--1:#F97583\">for</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> j</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">2</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;j</span><span style=\"--0:#F97583;--1:#F97583\">&#x3C;=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">b;j</span><span style=\"--0:#F97583;--1:#F97583\">++</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">){</span></div></div><div class=\"ec-line\" style=\"--ecIndent:12ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">31</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">            </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">f[i][j]</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1.0</span><span style=\"--0:#F97583;--1:#F97583\">*</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">i</span><span style=\"--0:#F97583;--1:#F97583\">/</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(i</span><span style=\"--0:#F97583;--1:#F97583\">+</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">j);</span></div></div><div class=\"ec-line\" style=\"--ecIndent:12ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">32</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">            </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">f[i][j]</span><span style=\"--0:#F97583;--1:#F97583\">+=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1.0</span><span style=\"--0:#F97583;--1:#F97583\">*</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">j</span><span style=\"--0:#F97583;--1:#F97583\">/</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(i</span><span style=\"--0:#F97583;--1:#F97583\">+</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">j)</span><span style=\"--0:#F97583;--1:#F97583\">*</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(j</span><span style=\"--0:#F97583;--1:#F97583\">-</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">)</span><span style=\"--0:#F97583;--1:#F97583\">/</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(i</span><span style=\"--0:#F97583;--1:#F97583\">+</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">j</span><span style=\"--0:#F97583;--1:#F97583\">-</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">)</span><span style=\"--0:#F97583;--1:#F97583\">*</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">i</span><span style=\"--0:#F97583;--1:#F97583\">/</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(i</span><span style=\"--0:#F97583;--1:#F97583\">+</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">j</span><span style=\"--0:#F97583;--1:#F97583\">-</span><span style=\"--0:#79B8FF;--1:#79B8FF\">2</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">)</span><span style=\"--0:#F97583;--1:#F97583\">*</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">f[i</span><span style=\"--0:#F97583;--1:#F97583\">-</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">][j</span><span style=\"--0:#F97583;--1:#F97583\">-</span><span style=\"--0:#79B8FF;--1:#79B8FF\">2</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">];</span></div></div><div class=\"ec-line\" style=\"--ecIndent:12ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">33</div></div><div class=\"code\"><span class=\"indent\">            </span><span style=\"--0:#F97583;--1:#F97583\">if</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(j</span><span style=\"--0:#F97583;--1:#F97583\">^</span><span style=\"--0:#79B8FF;--1:#79B8FF\">2</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">) f[i][j]</span><span style=\"--0:#F97583;--1:#F97583\">+=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1.0</span><span style=\"--0:#F97583;--1:#F97583\">*</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">j</span><span style=\"--0:#F97583;--1:#F97583\">/</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(i</span><span style=\"--0:#F97583;--1:#F97583\">+</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">j)</span><span style=\"--0:#F97583;--1:#F97583\">*</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(j</span><span style=\"--0:#F97583;--1:#F97583\">-</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">)</span><span style=\"--0:#F97583;--1:#F97583\">/</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(i</span><span style=\"--0:#F97583;--1:#F97583\">+</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">j</span><span style=\"--0:#F97583;--1:#F97583\">-</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">)</span><span style=\"--0:#F97583;--1:#F97583\">*</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(j</span><span style=\"--0:#F97583;--1:#F97583\">-</span><span style=\"--0:#79B8FF;--1:#79B8FF\">2</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">)</span><span style=\"--0:#F97583;--1:#F97583\">/</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(i</span><span style=\"--0:#F97583;--1:#F97583\">+</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">j</span><span style=\"--0:#F97583;--1:#F97583\">-</span><span style=\"--0:#79B8FF;--1:#79B8FF\">2</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">)</span><span style=\"--0:#F97583;--1:#F97583\">*</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">f[i][j</span><span style=\"--0:#F97583;--1:#F97583\">-</span><span style=\"--0:#79B8FF;--1:#79B8FF\">3</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">];</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">34</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">        </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">}</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">35</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">    </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">}</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">36</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">    </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">cout</span><span style=\"--0:#F97583;--1:#F97583\">&#x3C;&#x3C;</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">fixed</span><span style=\"--0:#F97583;--1:#F97583\">&#x3C;&#x3C;</span><span style=\"--0:#B392F0;--1:#B392F0\">setprecision</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#79B8FF;--1:#79B8FF\">9</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">)</span><span style=\"--0:#F97583;--1:#F97583\">&#x3C;&#x3C;</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">f[w][b]</span><span style=\"--0:#F97583;--1:#F97583\">&#x3C;&#x3C;</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">'</span><span style=\"--0:#79B8FF;--1:#79B8FF\">\\n</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">'</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">37</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#F97583;--1:#F97583\">return</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">38</div></div><div class=\"code\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">}</span></div></div></code><button class=\"copy-btn\" aria-label=\"Copy code\"><div class=\"copy-btn-icon\"><svg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon copy-icon\"><path d=\"M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z\"></path></svg><svg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon success-icon\"><path d=\"m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z\"></path></svg></div></button></pre></figure></div></section></section><section><h2 id=\"期望-dptextdpdp\">期望 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>DP</mtext></mrow><annotation encoding=\"application/x-tex\">\\text{DP}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord text\"><span class=\"mord\">DP</span></span></span></span></span><a class=\"anchor\" href=\"#期望-dptextdpdp\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h2><p>下面的题目都带有“期望”。\n常见的离散期望可以表示为某个事件的权值乘发生的概率之和。\n⼀些期望题就是符合条件的方案数除以总方案数。\n另⼀些考察期望线性性的题就比较难了，需要合理的拆分期望。</p><section><h3 id=\"例题1at_dp_j-sushi\">例题1：<a href=\"https://atcoder.jp/contests/dp/tasks/dp_j\">AT_dp_j</a> <a href=\"https://www.luogu.com.cn/problem/AT_dp_j\">Sushi</a><a class=\"anchor\" href=\"#例题1at_dp_j-sushi\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h3><p>现有 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span> (<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo>≤</mo><mi>N</mi><mo>≤</mo><mn>300</mn></mrow><annotation encoding=\"application/x-tex\">1 \\le N \\le 300</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7804em;vertical-align:-0.136em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8193em;vertical-align:-0.136em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">300</span></span></span></span>)个盘子，编号为 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo separator=\"true\">,</mo><mn>2</mn><mo separator=\"true\">,</mo><mn>3</mn><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">1,2,3,…,N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">2</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">3</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span>。第 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span> 个盘子中放有 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>a</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">a_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> (<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo>≤</mo><msub><mi>a</mi><mi>i</mi></msub><mo>≤</mo><mn>3</mn></mrow><annotation encoding=\"application/x-tex\">1 \\le a_i \\le 3</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7804em;vertical-align:-0.136em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.786em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">3</span></span></span></span>)个寿司。接下来每次执行以下操作，直至吃完所有的寿司。从第 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo separator=\"true\">,</mo><mn>2</mn><mo separator=\"true\">,</mo><mn>3</mn><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">1,2,3,…,N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">2</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">3</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span> 个盘子中任选一个盘子，吃掉其中的一个寿司。若没有寿司则不吃。若将所有寿司吃完，请问此时操作次数的数学期望是多少？\n范围：<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo>≤</mo><mi>N</mi><mo>≤</mo><mn>300</mn></mrow><annotation encoding=\"application/x-tex\">1 \\le N \\le 300</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7804em;vertical-align:-0.136em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8193em;vertical-align:-0.136em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">300</span></span></span></span>，<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo>≤</mo><msub><mi>a</mi><mi>i</mi></msub><mo>≤</mo><mn>3</mn></mrow><annotation encoding=\"application/x-tex\">1 \\le a_i \\le 3</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7804em;vertical-align:-0.136em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.786em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">3</span></span></span></span>。</p><p>设 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>f</mi><mrow><mi>i</mi><mo separator=\"true\">,</mo><mi>j</mi><mo separator=\"true\">,</mo><mi>k</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">f_{i,j,k}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9805em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span> 表示有 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span> 个盘子有 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span> 个寿司，<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>j</mi></mrow><annotation encoding=\"application/x-tex\">j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span></span></span></span> 个盘子有 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span></span></span></span> 个寿司，<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span> 个盘子有 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>3</mn></mrow><annotation encoding=\"application/x-tex\">3</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">3</span></span></span></span> 个寿司时吃完所有寿司的期望值。显然 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span> 个的有 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>−</mo><mi>i</mi><mo>−</mo><mi>j</mi><mo>−</mo><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">n-i-j-k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7429em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">i</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span> 个。\n考虑转移。枚举到那个数，则 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>f</mi><mrow><mi>i</mi><mo separator=\"true\">,</mo><mi>j</mi><mo separator=\"true\">,</mo><mi>k</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">f_{i,j,k}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9805em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span> 为以下四项之和：</p><ul>\n<li>枚举到 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>，<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi>n</mi><mo>−</mo><mi>i</mi><mo>−</mo><mi>j</mi><mo>−</mo><mi>k</mi></mrow><mi>n</mi></mfrac></mstyle><mo stretchy=\"false\">(</mo><msub><mi>f</mi><mrow><mi>i</mi><mo separator=\"true\">,</mo><mi>j</mi><mo separator=\"true\">,</mo><mi>k</mi></mrow></msub><mo>+</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\dfrac{n-i-j-k}n(f_{i,j,k}+1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.0574em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">n</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">i</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span></span>。</li>\n<li>枚举到 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>，<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mi>i</mi><mi>n</mi></mfrac></mstyle><mo stretchy=\"false\">(</mo><msub><mi>f</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn><mo separator=\"true\">,</mo><mi>j</mi><mo separator=\"true\">,</mo><mi>k</mi></mrow></msub><mo>+</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\dfrac in(f_{i-1,j,k}+1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.0225em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3365em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">n</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span></span>。</li>\n<li>枚举到 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span></span></span></span>，<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mi>j</mi><mi>n</mi></mfrac></mstyle><mo stretchy=\"false\">(</mo><msub><mi>f</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn><mo separator=\"true\">,</mo><mi>j</mi><mo>−</mo><mn>1</mn><mo separator=\"true\">,</mo><mi>k</mi></mrow></msub><mo>+</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\dfrac jn(f_{i+1,j-1,k}+1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.0225em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3365em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">n</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span></span>。</li>\n<li>枚举到 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>3</mn></mrow><annotation encoding=\"application/x-tex\">3</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">3</span></span></span></span>，<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mi>k</mi><mi>n</mi></mfrac></mstyle><mo stretchy=\"false\">(</mo><msub><mi>f</mi><mrow><mi>i</mi><mo separator=\"true\">,</mo><mi>j</mi><mo>+</mo><mn>1</mn><mo separator=\"true\">,</mo><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\dfrac kn(f_{i,j+1,k-1}+1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.0574em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">n</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span></span>。\n合并即是：<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>f</mi><mrow><mi>i</mi><mo separator=\"true\">,</mo><mi>j</mi><mo separator=\"true\">,</mo><mi>k</mi></mrow></msub><mo>=</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mo stretchy=\"false\">(</mo><mi>n</mi><mo>−</mo><mi>i</mi><mo>−</mo><mi>j</mi><mo>−</mo><mi>k</mi><mo stretchy=\"false\">)</mo><msub><mi>f</mi><mrow><mi>i</mi><mo separator=\"true\">,</mo><mi>j</mi><mo separator=\"true\">,</mo><mi>k</mi></mrow></msub><mo>+</mo><mi>i</mi><msub><mi>f</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn><mo separator=\"true\">,</mo><mi>j</mi><mo separator=\"true\">,</mo><mi>k</mi></mrow></msub><mo>+</mo><mi>j</mi><msub><mi>f</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn><mo separator=\"true\">,</mo><mi>j</mi><mo>−</mo><mn>1</mn><mo separator=\"true\">,</mo><mi>k</mi></mrow></msub><mo>+</mo><mi>k</mi><msub><mi>f</mi><mrow><mi>i</mi><mo separator=\"true\">,</mo><mi>j</mi><mo>+</mo><mn>1</mn><mo separator=\"true\">,</mo><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><mi>n</mi></mrow><mi>n</mi></mfrac></mstyle></mrow><annotation encoding=\"application/x-tex\">f_{i,j,k}=\\dfrac{(n-i-j-k)f_{i,j,k}+if_{i-1,j,k}+jf_{i+1,j-1,k}+kf_{i,j+1,k-1}+n}n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9805em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.113em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.427em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">n</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">i</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mclose\">)</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">i</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>。\n将以上式子化简得：<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>f</mi><mrow><mi>i</mi><mo separator=\"true\">,</mo><mi>j</mi><mo separator=\"true\">,</mo><mi>k</mi></mrow></msub><mo>=</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi>i</mi><msub><mi>f</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn><mo separator=\"true\">,</mo><mi>j</mi><mo separator=\"true\">,</mo><mi>k</mi></mrow></msub><mo>+</mo><mi>j</mi><msub><mi>f</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn><mo separator=\"true\">,</mo><mi>j</mi><mo>−</mo><mn>1</mn><mo separator=\"true\">,</mo><mi>k</mi></mrow></msub><mo>+</mo><mi>k</mi><msub><mi>f</mi><mrow><mi>i</mi><mo separator=\"true\">,</mo><mi>j</mi><mo>+</mo><mn>1</mn><mo separator=\"true\">,</mo><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><mi>n</mi></mrow><mrow><mi>i</mi><mo>+</mo><mi>j</mi><mo>+</mo><mi>k</mi></mrow></mfrac></mstyle></mrow><annotation encoding=\"application/x-tex\">f_{i,j,k}=\\dfrac{if_{i-1,j,k}+jf_{i+1,j-1,k}+kf_{i,j+1,k-1}+n}{i+j+k}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9805em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.2519em;vertical-align:-0.8804em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8804em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>。</li>\n</ul><div class=\"expressive-code\"><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"cpp\" class=\"wrap\" style=\"--ecMaxLine:88ch\"><code><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">1</div></div><div class=\"code\"><span style=\"--0:#F97583;--1:#F97583\">#include</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">&#x3C;bits/stdc++.h></span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">2</div></div><div class=\"code\"><span style=\"--0:#F97583;--1:#F97583\">using</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">namespace</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#B392F0;--1:#B392F0\">std</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">3</div></div><div class=\"code\"><span style=\"--0:#F97583;--1:#F97583\">const</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> N</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">305</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">4</div></div><div class=\"code\"><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> n,a[</span><span style=\"--0:#79B8FF;--1:#79B8FF\">10</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">];</span><span style=\"--0:#F97583;--1:#F97583\">double</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> f[N][N][N];</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">5</div></div><div class=\"code\"><span style=\"--0:#F97583;--1:#F97583\">namespace</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#B392F0;--1:#B392F0\">rw</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">{</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">6</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#F97583;--1:#F97583\">inline</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#B392F0;--1:#B392F0\">read</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(){</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">7</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> tot</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,t</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;</span><span style=\"--0:#F97583;--1:#F97583\">char</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> ch</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#B392F0;--1:#B392F0\">getchar</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">();</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">8</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#F97583;--1:#F97583\">while</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(ch</span><span style=\"--0:#F97583;--1:#F97583\">&#x3C;</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">'0'</span><span style=\"--0:#F97583;--1:#F97583\">||</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">ch</span><span style=\"--0:#F97583;--1:#F97583\">></span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">'9'</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">){</span><span style=\"--0:#F97583;--1:#F97583\">if</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(ch</span><span style=\"--0:#F97583;--1:#F97583\">==</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">'-'</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">) t</span><span style=\"--0:#F97583;--1:#F97583\">=-</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;ch</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#B392F0;--1:#B392F0\">getchar</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">();}</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">9</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#F97583;--1:#F97583\">while</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(ch</span><span style=\"--0:#F97583;--1:#F97583\">>=</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">'0'</span><span style=\"--0:#F97583;--1:#F97583\">&#x26;&#x26;</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">ch</span><span style=\"--0:#F97583;--1:#F97583\">&#x3C;=</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">'9'</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">){tot</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">tot</span><span style=\"--0:#F97583;--1:#F97583\">*</span><span style=\"--0:#79B8FF;--1:#79B8FF\">10</span><span style=\"--0:#F97583;--1:#F97583\">+</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">ch</span><span style=\"--0:#F97583;--1:#F97583\">-</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">'0'</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;ch</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#B392F0;--1:#B392F0\">getchar</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">();}</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">10</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#F97583;--1:#F97583\">return</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> tot</span><span style=\"--0:#F97583;--1:#F97583\">*</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">t;</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">11</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">    </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">}</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">12</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#F97583;--1:#F97583\">inline</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">void</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#B392F0;--1:#B392F0\">write</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#FFAB70;--1:#FFAB70\">x</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">){</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">13</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#F97583;--1:#F97583\">if</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(x</span><span style=\"--0:#F97583;--1:#F97583\">&#x3C;</span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">) </span><span style=\"--0:#B392F0;--1:#B392F0\">putchar</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">'-'</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">),x</span><span style=\"--0:#F97583;--1:#F97583\">=-</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">x;</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">14</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#F97583;--1:#F97583\">static</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> sta[</span><span style=\"--0:#79B8FF;--1:#79B8FF\">35</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">];</span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> top</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">15</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#F97583;--1:#F97583\">do</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">{sta[top</span><span style=\"--0:#F97583;--1:#F97583\">++</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">]</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">x</span><span style=\"--0:#F97583;--1:#F97583\">%</span><span style=\"--0:#79B8FF;--1:#79B8FF\">10</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,x</span><span style=\"--0:#F97583;--1:#F97583\">/=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">10</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;}</span><span style=\"--0:#F97583;--1:#F97583\">while</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(x);</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">16</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#F97583;--1:#F97583\">while</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(top) </span><span style=\"--0:#B392F0;--1:#B392F0\">putchar</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(sta[</span><span style=\"--0:#F97583;--1:#F97583\">--</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">top]</span><span style=\"--0:#F97583;--1:#F97583\">+</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">'0'</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">);</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">17</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">    </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">}</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">18</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#F97583;--1:#F97583\">inline</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">void</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#B392F0;--1:#B392F0\">file</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(){</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">19</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#B392F0;--1:#B392F0\">freopen</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">\".in\"</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">\"r\"</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,stdin);</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">20</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#B392F0;--1:#B392F0\">freopen</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">\".out\"</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">\"w\"</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,stdout);</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">21</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">    </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">}</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">22</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#F97583;--1:#F97583\">inline</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">void</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#B392F0;--1:#B392F0\">print</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#F97583;--1:#F97583\">const</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#FFAB70;--1:#FFAB70\">x</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,</span><span style=\"--0:#F97583;--1:#F97583\">const</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">char</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#FFAB70;--1:#FFAB70\">ch</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">){</span><span style=\"--0:#F97583;--1:#F97583\">return</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> (</span><span style=\"--0:#B392F0;--1:#B392F0\">write</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(x),</span><span style=\"--0:#B392F0;--1:#B392F0\">putchar</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(ch)),</span><span style=\"--0:#F97583;--1:#F97583\">void</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">);}</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">23</div></div><div class=\"code\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">}</span><span style=\"--0:#F97583;--1:#F97583\">using</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">namespace</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#B392F0;--1:#B392F0\">rw</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">24</div></div><div class=\"code\"><span style=\"--0:#F97583;--1:#F97583\">signed</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#B392F0;--1:#B392F0\">main</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(){</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">25</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">    </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">n</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#B392F0;--1:#B392F0\">read</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">();</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">26</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#F97583;--1:#F97583\">for</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> i</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;i</span><span style=\"--0:#F97583;--1:#F97583\">&#x3C;=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">n;i</span><span style=\"--0:#F97583;--1:#F97583\">++</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">){</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">27</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> x</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#B392F0;--1:#B392F0\">read</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">();</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">28</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">        </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">a[x]</span><span style=\"--0:#F97583;--1:#F97583\">++</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">29</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">    </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">}</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">30</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#F97583;--1:#F97583\">for</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> k</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;k</span><span style=\"--0:#F97583;--1:#F97583\">&#x3C;=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">n;k</span><span style=\"--0:#F97583;--1:#F97583\">++</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">){</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">31</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#F97583;--1:#F97583\">for</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> j</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;j</span><span style=\"--0:#F97583;--1:#F97583\">&#x3C;=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">n;j</span><span style=\"--0:#F97583;--1:#F97583\">++</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">){</span></div></div><div class=\"ec-line\" style=\"--ecIndent:12ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">32</div></div><div class=\"code\"><span class=\"indent\">            </span><span style=\"--0:#F97583;--1:#F97583\">for</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> i</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;i</span><span style=\"--0:#F97583;--1:#F97583\">&#x3C;=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">n;i</span><span style=\"--0:#F97583;--1:#F97583\">++</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">){</span></div></div><div class=\"ec-line\" style=\"--ecIndent:16ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">33</div></div><div class=\"code\"><span class=\"indent\">                </span><span style=\"--0:#F97583;--1:#F97583\">if</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#F97583;--1:#F97583\">!</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">i</span><span style=\"--0:#F97583;--1:#F97583\">&#x26;&#x26;!</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">j</span><span style=\"--0:#F97583;--1:#F97583\">&#x26;&#x26;!</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">k) </span><span style=\"--0:#F97583;--1:#F97583\">continue</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;</span></div></div><div class=\"ec-line\" style=\"--ecIndent:16ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">34</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">                </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">f[i][j][k]</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">n;</span></div></div><div class=\"ec-line\" style=\"--ecIndent:16ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">35</div></div><div class=\"code\"><span class=\"indent\">                </span><span style=\"--0:#F97583;--1:#F97583\">if</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(i) f[i][j][k]</span><span style=\"--0:#F97583;--1:#F97583\">+=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">i</span><span style=\"--0:#F97583;--1:#F97583\">*</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">f[i</span><span style=\"--0:#F97583;--1:#F97583\">-</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">][j][k];</span></div></div><div class=\"ec-line\" style=\"--ecIndent:16ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">36</div></div><div class=\"code\"><span class=\"indent\">                </span><span style=\"--0:#F97583;--1:#F97583\">if</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(j) f[i][j][k]</span><span style=\"--0:#F97583;--1:#F97583\">+=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">j</span><span style=\"--0:#F97583;--1:#F97583\">*</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">f[i</span><span style=\"--0:#F97583;--1:#F97583\">+</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">][j</span><span style=\"--0:#F97583;--1:#F97583\">-</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">][k];</span></div></div><div class=\"ec-line\" style=\"--ecIndent:16ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">37</div></div><div class=\"code\"><span class=\"indent\">                </span><span style=\"--0:#F97583;--1:#F97583\">if</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(k) f[i][j][k]</span><span style=\"--0:#F97583;--1:#F97583\">+=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">k</span><span style=\"--0:#F97583;--1:#F97583\">*</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">f[i][j</span><span style=\"--0:#F97583;--1:#F97583\">+</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">][k</span><span style=\"--0:#F97583;--1:#F97583\">-</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">];</span></div></div><div class=\"ec-line\" style=\"--ecIndent:16ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">38</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">                </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">f[i][j][k]</span><span style=\"--0:#F97583;--1:#F97583\">/=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">i</span><span style=\"--0:#F97583;--1:#F97583\">+</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">j</span><span style=\"--0:#F97583;--1:#F97583\">+</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">k;</span></div></div><div class=\"ec-line\" style=\"--ecIndent:12ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">39</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">            </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">}</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">40</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">        </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">}</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">41</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">    </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">}</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">42</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">    </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">cout</span><span style=\"--0:#F97583;--1:#F97583\">&#x3C;&#x3C;</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">fixed</span><span style=\"--0:#F97583;--1:#F97583\">&#x3C;&#x3C;</span><span style=\"--0:#B392F0;--1:#B392F0\">setprecision</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#79B8FF;--1:#79B8FF\">10</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">)</span><span style=\"--0:#F97583;--1:#F97583\">&#x3C;&#x3C;</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">f[a[</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">]][a[</span><span style=\"--0:#79B8FF;--1:#79B8FF\">2</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">]][a[</span><span style=\"--0:#79B8FF;--1:#79B8FF\">3</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">]]</span><span style=\"--0:#F97583;--1:#F97583\">&#x3C;&#x3C;</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">'</span><span style=\"--0:#79B8FF;--1:#79B8FF\">\\n</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">'</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">43</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#F97583;--1:#F97583\">return</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">44</div></div><div class=\"code\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">}</span></div></div></code><button class=\"copy-btn\" aria-label=\"Copy code\"><div class=\"copy-btn-icon\"><svg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon copy-icon\"><path d=\"M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z\"></path></svg><svg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon success-icon\"><path d=\"m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z\"></path></svg></div></button></pre></figure></div></section></section><section><h2 id=\"待定系数法\">待定系数法<a class=\"anchor\" href=\"#待定系数法\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h2><p>设 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>f</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">f_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 表⽰从 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span> 开始走到终点的期望步数。\n那么 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>f</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">f_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 可以用 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi><mo>×</mo><msub><mi>f</mi><mn>0</mn></msub><mo>+</mo><mi>b</mi></mrow><annotation encoding=\"application/x-tex\">k \\times f_0 +b</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7778em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">b</span></span></span></span> 来表⽰，最后解出 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>f</mi><mn>0</mn></msub></mrow><annotation encoding=\"application/x-tex\">f_0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 即可。</p><hr></section></section>\n<section><h1 id=\"dptextdpdp-方法\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>DP</mtext></mrow><annotation encoding=\"application/x-tex\">\\text{DP}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord text\"><span class=\"mord\">DP</span></span></span></span></span> 方法<a class=\"anchor\" href=\"#dptextdpdp-方法\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h1><section><h2 id=\"排列方法\">排列方法<a class=\"anchor\" href=\"#排列方法\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h2><p>通常是不给出排列，形如求满足某条件的所有排列的权值之和的问题。</p><section><h3 id=\"逐步生成\">逐步生成<a class=\"anchor\" href=\"#逐步生成\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h3><ul>\n<li>从左往右依次确定绝对值</li>\n<li>从小到大依次确定绝对位置</li>\n<li>从左往右依次确定相对大小(在前缀中的排名)</li>\n<li>从小到大依次插入序列中</li>\n</ul></section><section><h3 id=\"例题1at_dp_t-permutation\">例题1：<a href=\"https://atcoder.jp/contests/dp/tasks/dp_t\">AT_dp_t</a> <a href=\"https://www.luogu.com.cn/problem/AT_dp_t\">Permutation</a><a class=\"anchor\" href=\"#例题1at_dp_t-permutation\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h3><p>有一个长为 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span> 的正整数排列。给定一个由 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>&#x3C;</mo></mrow><annotation encoding=\"application/x-tex\">&#x3C;</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span class=\"mrel\">&#x3C;</span></span></span></span> 和 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>></mo></mrow><annotation encoding=\"application/x-tex\">></annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span class=\"mrel\">></span></span></span></span> 组成长为 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">N−1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span> 的的字符串。 对于任意满足 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo>≤</mo><mi>i</mi><mo>≤</mo><mi>N</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">1 \\le i \\le N−1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7804em;vertical-align:-0.136em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7955em;vertical-align:-0.136em;\"></span><span class=\"mord mathnormal\">i</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span> 的字符 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>s</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">s_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>，如果 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>s</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">s_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 是 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>&#x3C;</mo></mrow><annotation encoding=\"application/x-tex\">&#x3C;</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span class=\"mrel\">&#x3C;</span></span></span></span> 则 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>P</mi><mi>i</mi></msub><mo>&#x3C;</mo><msub><mi>P</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding=\"application/x-tex\">P_i&#x3C;P_{i+1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&#x3C;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8917em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span></span></span></span> 如果 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>s</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">s_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 是 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>></mo></mrow><annotation encoding=\"application/x-tex\">></annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span class=\"mrel\">></span></span></span></span> 则 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>P</mi><mi>i</mi></msub><mo>></mo><msub><mi>P</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding=\"application/x-tex\">P_i>P_{i+1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8917em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span></span></span></span>。求满足这样的性质的排列 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>P</mi></mrow><annotation encoding=\"application/x-tex\">P</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span></span></span></span> 的方案数。答案对 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mn>10</mn><mn>9</mn></msup><mo>+</mo><mn>7</mn></mrow><annotation encoding=\"application/x-tex\">10^9+7</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8974em;vertical-align:-0.0833em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">9</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">7</span></span></span></span> 取模。\n范围：<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>2</mn><mo>≤</mo><mi>N</mi><mo>≤</mo><mn>3000</mn></mrow><annotation encoding=\"application/x-tex\">2 \\le N \\le 3000</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7804em;vertical-align:-0.136em;\"></span><span class=\"mord\">2</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8193em;vertical-align:-0.136em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">3000</span></span></span></span>。</p><p>这里采用 <em>从左往右依次确定相对大小(在前缀中的排名)</em> 的方法求解。\n首先设 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>f</mi><mrow><mi>i</mi><mo separator=\"true\">,</mo><mi>j</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">f_{i,j}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9805em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span> 表示在前 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span> 个位置上填入 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo>→</mo><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">1 \\to i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span>，且最后一位为 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>j</mi></mrow><annotation encoding=\"application/x-tex\">j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span></span></span></span> 的方案数，显然边界为 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>f</mi><mrow><mn>1</mn><mo separator=\"true\">,</mo><mn>1</mn></mrow></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">f_{1,1}=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9805em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span><span class=\"mpunct mtight\">,</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>。接下来考虑转移。我们可以将前 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">i-1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7429em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">i</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span> 中 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>≥</mo><mi>j</mi></mrow><annotation encoding=\"application/x-tex\">\\geq j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7719em;vertical-align:-0.136em;\"></span><span class=\"mrel\">≥</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span></span></span></span> 都 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>+</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">+1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">+</span><span class=\"mord\">1</span></span></span></span> 以保证是排列，枚举第 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">i-1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7429em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">i</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span> 个数是多少，我们就得到了转移方程：\n<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mrow><mo fence=\"true\">{</mo><mtable rowspacing=\"0.25em\" columnalign=\"right\" columnspacing=\"\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msubsup><mo>∑</mo><mrow><mi>j</mi><mo>−</mo><mn>1</mn></mrow><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow></msubsup></mstyle><msub><mi>f</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn><mo separator=\"true\">,</mo><mi>k</mi></mrow></msub><mtext>，</mtext><msub><mi>s</mi><mi>i</mi></msub><mo>=</mo><mi mathvariant=\"normal\">\"</mi><mo>&#x3C;</mo><mi mathvariant=\"normal\">\"</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow></msubsup></mstyle><msub><mi>f</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn><mo separator=\"true\">,</mo><mi>k</mi></mrow></msub><mtext>，</mtext><msub><mi>s</mi><mi>i</mi></msub><mo>=</mo><mi mathvariant=\"normal\">\"</mi><mo>></mo><mi mathvariant=\"normal\">\"</mi></mrow></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding=\"application/x-tex\"> f(x)=\\left\\{\\begin{aligned}{\\textstyle \\sum_{j-1}^{k=1}} f_{i-1,k}，s_i=\"&#x3C;\" \\\\{\\textstyle \\sum_{i-1}^{k=1}} f_{i-1,k}，s_i=\">\"\\end{aligned}\\right.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:3.6em;vertical-align:-1.55em;\"></span><span class=\"minner\"><span class=\"mopen\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.05em;\"><span style=\"top:-2.5em;\"><span class=\"pstrut\" style=\"height:3.15em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎩</span></span></span><span style=\"top:-2.492em;\"><span class=\"pstrut\" style=\"height:3.15em;\"></span><span style=\"height:0.016em;width:0.8889em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"0.8889em\" height=\"0.016em\" style=\"width:0.8889em\" viewBox=\"0 0 888.89 16\" preserveAspectRatio=\"xMinYMin\"><path d=\"M384 0 H504 V16 H384z M384 0 H504 V16 H384z\"></path></svg></span></span><span style=\"top:-3.15em;\"><span class=\"pstrut\" style=\"height:3.15em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎨</span></span></span><span style=\"top:-4.292em;\"><span class=\"pstrut\" style=\"height:3.15em;\"></span><span style=\"height:0.016em;width:0.8889em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"0.8889em\" height=\"0.016em\" style=\"width:0.8889em\" viewBox=\"0 0 888.89 16\" preserveAspectRatio=\"xMinYMin\"><path d=\"M384 0 H504 V16 H384z M384 0 H504 V16 H384z\"></path></svg></span></span><span style=\"top:-4.3em;\"><span class=\"pstrut\" style=\"height:3.15em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎧</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.55em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-r\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.9369em;\"><span style=\"top:-3.9479em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">∑</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.989em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.2029em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4358em;\"><span></span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mord cjk_fallback\">，</span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\">\"</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&#x3C;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\">\"</span></span></span><span style=\"top:-2.2231em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">∑</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.989em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.2029em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.358em;\"><span></span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mord cjk_fallback\">，</span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\">\"</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\">\"</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.4369em;\"><span></span></span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></p><div class=\"expressive-code\"><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"cpp\" class=\"wrap\" style=\"--ecMaxLine:88ch\"><code><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">1</div></div><div class=\"code\"><span style=\"--0:#F97583;--1:#F97583\">#include</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">&#x3C;bits/stdc++.h></span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">2</div></div><div class=\"code\"><span style=\"--0:#F97583;--1:#F97583\">#define</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#B392F0;--1:#B392F0\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">long</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">long</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">3</div></div><div class=\"code\"><span style=\"--0:#F97583;--1:#F97583\">using</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">namespace</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#B392F0;--1:#B392F0\">std</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">4</div></div><div class=\"code\"><span style=\"--0:#F97583;--1:#F97583\">const</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> N</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">3005</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,mod</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#F97583;--1:#F97583\">e</span><span style=\"--0:#79B8FF;--1:#79B8FF\">9</span><span style=\"--0:#F97583;--1:#F97583\">+</span><span style=\"--0:#79B8FF;--1:#79B8FF\">7</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">5</div></div><div class=\"code\"><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> n,f[N][N],sum[N][N];</span><span style=\"--0:#F97583;--1:#F97583\">char</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> s[N];</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">6</div></div><div class=\"code\"><span style=\"--0:#F97583;--1:#F97583\">namespace</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#B392F0;--1:#B392F0\">rw</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">{</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">7</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#F97583;--1:#F97583\">inline</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#B392F0;--1:#B392F0\">read</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(){</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">8</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> tot</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,t</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;</span><span style=\"--0:#F97583;--1:#F97583\">char</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> ch</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#B392F0;--1:#B392F0\">getchar</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">();</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">9</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#F97583;--1:#F97583\">while</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(ch</span><span style=\"--0:#F97583;--1:#F97583\">&#x3C;</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">'0'</span><span style=\"--0:#F97583;--1:#F97583\">||</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">ch</span><span style=\"--0:#F97583;--1:#F97583\">></span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">'9'</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">){</span><span style=\"--0:#F97583;--1:#F97583\">if</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(ch</span><span style=\"--0:#F97583;--1:#F97583\">==</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">'-'</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">) t</span><span style=\"--0:#F97583;--1:#F97583\">=-</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;ch</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#B392F0;--1:#B392F0\">getchar</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">();}</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">10</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#F97583;--1:#F97583\">while</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(ch</span><span style=\"--0:#F97583;--1:#F97583\">>=</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">'0'</span><span style=\"--0:#F97583;--1:#F97583\">&#x26;&#x26;</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">ch</span><span style=\"--0:#F97583;--1:#F97583\">&#x3C;=</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">'9'</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">){tot</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">tot</span><span style=\"--0:#F97583;--1:#F97583\">*</span><span style=\"--0:#79B8FF;--1:#79B8FF\">10</span><span style=\"--0:#F97583;--1:#F97583\">+</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">ch</span><span style=\"--0:#F97583;--1:#F97583\">-</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">'0'</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;ch</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#B392F0;--1:#B392F0\">getchar</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">();}</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">11</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#F97583;--1:#F97583\">return</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> tot</span><span style=\"--0:#F97583;--1:#F97583\">*</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">t;</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">12</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">    </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">}</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">13</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#F97583;--1:#F97583\">inline</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">void</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#B392F0;--1:#B392F0\">write</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#FFAB70;--1:#FFAB70\">x</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">){</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">14</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#F97583;--1:#F97583\">if</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(x</span><span style=\"--0:#F97583;--1:#F97583\">&#x3C;</span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">) </span><span style=\"--0:#B392F0;--1:#B392F0\">putchar</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">'-'</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">),x</span><span style=\"--0:#F97583;--1:#F97583\">=-</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">x;</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">15</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#F97583;--1:#F97583\">static</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> sta[</span><span style=\"--0:#79B8FF;--1:#79B8FF\">35</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">];</span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> top</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">16</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#F97583;--1:#F97583\">do</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">{sta[top</span><span style=\"--0:#F97583;--1:#F97583\">++</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">]</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">x</span><span style=\"--0:#F97583;--1:#F97583\">%</span><span style=\"--0:#79B8FF;--1:#79B8FF\">10</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,x</span><span style=\"--0:#F97583;--1:#F97583\">/=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">10</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;}</span><span style=\"--0:#F97583;--1:#F97583\">while</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(x);</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">17</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#F97583;--1:#F97583\">while</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(top) </span><span style=\"--0:#B392F0;--1:#B392F0\">putchar</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(sta[</span><span style=\"--0:#F97583;--1:#F97583\">--</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">top]</span><span style=\"--0:#F97583;--1:#F97583\">+</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">'0'</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">);</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">18</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">    </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">}</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">19</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#F97583;--1:#F97583\">inline</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">void</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#B392F0;--1:#B392F0\">file</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(){</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">20</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#B392F0;--1:#B392F0\">freopen</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">\".in\"</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">\"r\"</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,stdin);</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">21</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#B392F0;--1:#B392F0\">freopen</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">\".out\"</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">\"w\"</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,stdout);</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">22</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">    </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">}</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">23</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#F97583;--1:#F97583\">inline</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">void</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#B392F0;--1:#B392F0\">print</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#F97583;--1:#F97583\">const</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#FFAB70;--1:#FFAB70\">x</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,</span><span style=\"--0:#F97583;--1:#F97583\">const</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">char</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#FFAB70;--1:#FFAB70\">ch</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">){</span><span style=\"--0:#F97583;--1:#F97583\">return</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> (</span><span style=\"--0:#B392F0;--1:#B392F0\">write</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(x),</span><span style=\"--0:#B392F0;--1:#B392F0\">putchar</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(ch)),</span><span style=\"--0:#F97583;--1:#F97583\">void</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">);}</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">24</div></div><div class=\"code\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">}</span><span style=\"--0:#F97583;--1:#F97583\">using</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">namespace</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#B392F0;--1:#B392F0\">rw</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">25</div></div><div class=\"code\"><span style=\"--0:#F97583;--1:#F97583\">signed</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#B392F0;--1:#B392F0\">main</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(){</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">26</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">    </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">n</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#B392F0;--1:#B392F0\">read</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">();</span><span style=\"--0:#F97583;--1:#F97583\">for</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> i</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;i</span><span style=\"--0:#F97583;--1:#F97583\">&#x3C;=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">n;i</span><span style=\"--0:#F97583;--1:#F97583\">++</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">) s[i]</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#B392F0;--1:#B392F0\">getchar</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">();f[</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">][</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">]</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">27</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#F97583;--1:#F97583\">for</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> i</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;i</span><span style=\"--0:#F97583;--1:#F97583\">&#x3C;=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">n;i</span><span style=\"--0:#F97583;--1:#F97583\">++</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">) sum[</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">][i]</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">28</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#F97583;--1:#F97583\">for</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> i</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">2</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;i</span><span style=\"--0:#F97583;--1:#F97583\">&#x3C;=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">n;i</span><span style=\"--0:#F97583;--1:#F97583\">++</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">){</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">29</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#F97583;--1:#F97583\">for</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> j</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;j</span><span style=\"--0:#F97583;--1:#F97583\">&#x3C;=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">i;j</span><span style=\"--0:#F97583;--1:#F97583\">++</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">){</span></div></div><div class=\"ec-line\" style=\"--ecIndent:12ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">30</div></div><div class=\"code\"><span class=\"indent\">            </span><span style=\"--0:#F97583;--1:#F97583\">if</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(s[i</span><span style=\"--0:#F97583;--1:#F97583\">-</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">]</span><span style=\"--0:#F97583;--1:#F97583\">==</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">'&#x3C;'</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">) f[i][j]</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">sum[i</span><span style=\"--0:#F97583;--1:#F97583\">-</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">][j</span><span style=\"--0:#F97583;--1:#F97583\">-</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">]</span><span style=\"--0:#F97583;--1:#F97583\">%</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">mod;</span></div></div><div class=\"ec-line\" style=\"--ecIndent:12ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">31</div></div><div class=\"code\"><span class=\"indent\">            </span><span style=\"--0:#F97583;--1:#F97583\">if</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(s[i</span><span style=\"--0:#F97583;--1:#F97583\">-</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">]</span><span style=\"--0:#F97583;--1:#F97583\">==</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">'>'</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">) f[i][j]</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(sum[i</span><span style=\"--0:#F97583;--1:#F97583\">-</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">][i</span><span style=\"--0:#F97583;--1:#F97583\">-</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">]</span><span style=\"--0:#F97583;--1:#F97583\">-</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">sum[i</span><span style=\"--0:#F97583;--1:#F97583\">-</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">][j</span><span style=\"--0:#F97583;--1:#F97583\">-</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">]</span><span style=\"--0:#F97583;--1:#F97583\">+</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">mod)</span><span style=\"--0:#F97583;--1:#F97583\">%</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">mod;</span></div></div><div class=\"ec-line\" style=\"--ecIndent:12ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">32</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">            </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">sum[i][j]</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(sum[i][j</span><span style=\"--0:#F97583;--1:#F97583\">-</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">]</span><span style=\"--0:#F97583;--1:#F97583\">+</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">f[i][j])</span><span style=\"--0:#F97583;--1:#F97583\">%</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">mod;</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">33</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">        </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">}</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">34</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">    </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">}</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">35</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#B392F0;--1:#B392F0\">print</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(sum[n][n]</span><span style=\"--0:#F97583;--1:#F97583\">%</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">mod,</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">'</span><span style=\"--0:#79B8FF;--1:#79B8FF\">\\n</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">'</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">);</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">36</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#F97583;--1:#F97583\">return</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">37</div></div><div class=\"code\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">}</span></div></div></code><button class=\"copy-btn\" aria-label=\"Copy code\"><div class=\"copy-btn-icon\"><svg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon copy-icon\"><path d=\"M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z\"></path></svg><svg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon success-icon\"><path d=\"m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z\"></path></svg></div></button></pre></figure></div></section><section><h3 id=\"例题2cf1806d-dsu-master\">例题2：<a href=\"https://codeforces.com/contest/1806/problem/D\">CF1806D</a> <a href=\"https://www.luogu.com.cn/problem/CF1806D\">DSU Master</a><a class=\"anchor\" href=\"#例题2cf1806d-dsu-master\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h3><p>给出序列 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi></mrow><annotation encoding=\"application/x-tex\">a</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">a</span></span></span></span>。对于一个长度为 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">m−1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span> 的排列 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi></mrow><annotation encoding=\"application/x-tex\">p</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">p</span></span></span></span>，定义它的价值如下：有一个初始为森林的并查集，按照 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>p</mi><mn>1</mn></msub><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><msub><mi>p</mi><mi>m</mi></msub><mo>−</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">p_1...p_m-1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7778em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">...</span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span> 的顺序合并并查集 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>p</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">p_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 和 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>p</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding=\"application/x-tex\">p_{i+1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6389em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span></span></span></span>，如果 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>a</mi><msub><mi>p</mi><mi>i</mi></msub></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">a_{p_{i}}=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7167em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3281em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>，那么将 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>p</mi><mi>i</mi></msub><mo>+</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">p_{i}+1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7778em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span> 所在的并查集的根并到 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>p</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">p_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 所在的并查集的根上，否则将 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>p</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">p_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 并所在并查集到 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>p</mi><mi>i</mi></msub><mo>+</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">p_i+1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7778em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span> 所在的并查集的根上，进行完所有操作后 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span> 的儿子的个数。你需要对于所有 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi><mo>∈</mo><mo stretchy=\"false\">[</mo><mn>1</mn><mo separator=\"true\">,</mo><mi>n</mi><mo>−</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">k \\in [1,n−1]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7335em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span></span></span></span> 求出长度为 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span> 的 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi><mo stretchy=\"false\">!</mo></mrow><annotation encoding=\"application/x-tex\">k!</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mclose\">!</span></span></span></span> 中排列顺序的价值和，对 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>998244353</mn></mrow><annotation encoding=\"application/x-tex\">998244353</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">998244353</span></span></span></span> 取模。</p><p>根据连边方式，⼀个连通块始终是值域上的⼀个区间。\n首先拆贡献，考虑 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>p</mi><mi>i</mi></msub><mo>=</mo><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">p_i=x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span> 什么时候会产生贡献，首先要 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>a</mi><mi>x</mi></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">a_x=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>，然后连 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>x</mi><mo>+</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(x,x+1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span></span>，要求是 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo>→</mo><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">1 \\to x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span> 已经连通，也就是在 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>p</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><msub><mi>p</mi><mn>2</mn></msub><mo separator=\"true\">,</mo><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mo separator=\"true\">,</mo><msub><mi>p</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><annotation encoding=\"application/x-tex\">p_1,p_2,...,p_{i-1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6389em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">...</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span></span></span></span> 中出现了 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo>→</mo><mi>x</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">1 \\to x-1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>，<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>a</mi><mi>x</mi></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">a_x=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span> 时满足这个条件会消除后续的所有贡献。\n设 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi><mi>n</mi><msub><mi>s</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">ans_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord mathnormal\">an</span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 表示 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo>→</mo><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">1 \\to i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span> 所有排列的答案，<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>f</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">f_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 表示若 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>a</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">a_{i+1}=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6389em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span> 额外的贡献，考虑用<strong>从小到大依次插入序列中</strong>的方法。\n转移时考虑枚举 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span> 的位置，显然放前 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">i-1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7429em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">i</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span> 个空隙中不影响答案，<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>a</mi><mi>i</mi></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">a_i=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span> 时放在最后有额外的贡献，否则将贡献清空。这样状态转移方程就写出来了：</p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mo fence=\"true\">{</mo><mtable rowspacing=\"0.36em\" columnalign=\"left left\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><msub><mi>f</mi><mi>i</mi></msub><mo>=</mo><msub><mi>f</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>⋅</mo><mi>i</mi><mo separator=\"true\">,</mo><mtext>            </mtext><mi>a</mi><mi>n</mi><msub><mi>s</mi><mi>i</mi></msub><mo>=</mo><mi>a</mi><mi>n</mi><msub><mi>s</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>⋅</mo><mi>i</mi><mo>+</mo><msub><mi>f</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><msub><mi>a</mi><mi>i</mi></msub><mo>=</mo><mn>0</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><msub><mi>f</mi><mi>i</mi></msub><mo>=</mo><msub><mi>f</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>⋅</mo><mo stretchy=\"false\">(</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo><mtext>  </mtext><mi>a</mi><mi>n</mi><msub><mi>s</mi><mi>i</mi></msub><mo>=</mo><mi>a</mi><mi>n</mi><msub><mi>s</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>⋅</mo><mi>i</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><msub><mi>a</mi><mi>i</mi></msub><mo>=</mo><mn>1</mn></mrow></mstyle></mtd></mtr></mtable></mrow><annotation encoding=\"application/x-tex\">\\begin{cases}\nf_i=f_{i-1}\\cdot i,\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ ans_i=ans_{i-1}\\cdot i+f_{i-1}&#x26;a_i=0\\\\\nf_i=f_{i-1}\\cdot(i-1),\\ \\ ans_i=ans_{i-1}\\cdot i&#x26;a_i=1\n\\end{cases}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:3em;vertical-align:-1.25em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size4\">{</span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.69em;\"><span style=\"top:-3.69em;\"><span class=\"pstrut\" style=\"height:3.008em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">i</span><span class=\"mpunct\">,</span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">an</span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord mathnormal\">an</span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">i</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-2.25em;\"><span class=\"pstrut\" style=\"height:3.008em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">i</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">an</span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord mathnormal\">an</span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.19em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:1em;\"></span><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.69em;\"><span style=\"top:-3.69em;\"><span class=\"pstrut\" style=\"height:3.008em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\">0</span></span></span><span style=\"top:-2.25em;\"><span class=\"pstrut\" style=\"height:3.008em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.19em;\"><span></span></span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span><div class=\"expressive-code\"><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"cpp\" class=\"wrap\" style=\"--ecMaxLine:88ch\"><code><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">1</div></div><div class=\"code\"><span style=\"--0:#F97583;--1:#F97583\">#include</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">&#x3C;bits/stdc++.h></span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">2</div></div><div class=\"code\"><span style=\"--0:#F97583;--1:#F97583\">#define</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#B392F0;--1:#B392F0\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">long</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">long</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">3</div></div><div class=\"code\"><span style=\"--0:#F97583;--1:#F97583\">using</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">namespace</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#B392F0;--1:#B392F0\">std</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">4</div></div><div class=\"code\"><span style=\"--0:#F97583;--1:#F97583\">const</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> N</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">5</span><span style=\"--0:#F97583;--1:#F97583\">e</span><span style=\"--0:#79B8FF;--1:#79B8FF\">5</span><span style=\"--0:#F97583;--1:#F97583\">+</span><span style=\"--0:#79B8FF;--1:#79B8FF\">5</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,mod</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">998244353</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">5</div></div><div class=\"code\"><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> n,a[N],f[N],ans[N];</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">6</div></div><div class=\"code\"><span style=\"--0:#F97583;--1:#F97583\">namespace</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#B392F0;--1:#B392F0\">rw</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">{</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">7</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#F97583;--1:#F97583\">inline</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#B392F0;--1:#B392F0\">read</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(){</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">8</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> tot</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,t</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;</span><span style=\"--0:#F97583;--1:#F97583\">char</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> ch</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#B392F0;--1:#B392F0\">getchar</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">();</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">9</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#F97583;--1:#F97583\">while</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(ch</span><span style=\"--0:#F97583;--1:#F97583\">&#x3C;</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">'0'</span><span style=\"--0:#F97583;--1:#F97583\">||</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">ch</span><span style=\"--0:#F97583;--1:#F97583\">></span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">'9'</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">){</span><span style=\"--0:#F97583;--1:#F97583\">if</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(ch</span><span style=\"--0:#F97583;--1:#F97583\">==</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">'-'</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">) t</span><span style=\"--0:#F97583;--1:#F97583\">=-</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;ch</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#B392F0;--1:#B392F0\">getchar</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">();}</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">10</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#F97583;--1:#F97583\">while</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(ch</span><span style=\"--0:#F97583;--1:#F97583\">>=</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">'0'</span><span style=\"--0:#F97583;--1:#F97583\">&#x26;&#x26;</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">ch</span><span style=\"--0:#F97583;--1:#F97583\">&#x3C;=</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">'9'</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">){tot</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">tot</span><span style=\"--0:#F97583;--1:#F97583\">*</span><span style=\"--0:#79B8FF;--1:#79B8FF\">10</span><span style=\"--0:#F97583;--1:#F97583\">+</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">ch</span><span style=\"--0:#F97583;--1:#F97583\">-</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">'0'</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;ch</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#B392F0;--1:#B392F0\">getchar</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">();}</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">11</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#F97583;--1:#F97583\">return</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> tot</span><span style=\"--0:#F97583;--1:#F97583\">*</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">t;</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">12</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">    </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">}</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">13</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#F97583;--1:#F97583\">inline</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">void</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#B392F0;--1:#B392F0\">write</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#FFAB70;--1:#FFAB70\">x</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">){</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">14</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#F97583;--1:#F97583\">if</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(x</span><span style=\"--0:#F97583;--1:#F97583\">&#x3C;</span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">) </span><span style=\"--0:#B392F0;--1:#B392F0\">putchar</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">'-'</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">),x</span><span style=\"--0:#F97583;--1:#F97583\">=-</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">x;</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">15</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#F97583;--1:#F97583\">static</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> sta[</span><span style=\"--0:#79B8FF;--1:#79B8FF\">35</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">];</span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> top</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">16</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#F97583;--1:#F97583\">do</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">{sta[top</span><span style=\"--0:#F97583;--1:#F97583\">++</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">]</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">x</span><span style=\"--0:#F97583;--1:#F97583\">%</span><span style=\"--0:#79B8FF;--1:#79B8FF\">10</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,x</span><span style=\"--0:#F97583;--1:#F97583\">/=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">10</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;}</span><span style=\"--0:#F97583;--1:#F97583\">while</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(x);</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">17</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#F97583;--1:#F97583\">while</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(top) </span><span style=\"--0:#B392F0;--1:#B392F0\">putchar</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(sta[</span><span style=\"--0:#F97583;--1:#F97583\">--</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">top]</span><span style=\"--0:#F97583;--1:#F97583\">+</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">'0'</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">);</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">18</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">    </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">}</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">19</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#F97583;--1:#F97583\">inline</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">void</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#B392F0;--1:#B392F0\">file</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(){</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">20</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#B392F0;--1:#B392F0\">freopen</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">\".in\"</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">\"r\"</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,stdin);</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">21</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#B392F0;--1:#B392F0\">freopen</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">\".out\"</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">\"w\"</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,stdout);</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">22</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">    </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">}</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">23</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#F97583;--1:#F97583\">inline</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">void</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#B392F0;--1:#B392F0\">print</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#F97583;--1:#F97583\">const</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#FFAB70;--1:#FFAB70\">x</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">,</span><span style=\"--0:#F97583;--1:#F97583\">const</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">char</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#FFAB70;--1:#FFAB70\">ch</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">){</span><span style=\"--0:#F97583;--1:#F97583\">return</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> (</span><span style=\"--0:#B392F0;--1:#B392F0\">write</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(x),</span><span style=\"--0:#B392F0;--1:#B392F0\">putchar</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(ch)),</span><span style=\"--0:#F97583;--1:#F97583\">void</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">);}</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">24</div></div><div class=\"code\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">}</span><span style=\"--0:#F97583;--1:#F97583\">using</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">namespace</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#B392F0;--1:#B392F0\">rw</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">25</div></div><div class=\"code\"><span style=\"--0:#F97583;--1:#F97583\">inline</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#F97583;--1:#F97583\">void</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#B392F0;--1:#B392F0\">solve</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(){</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">26</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">    </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">n</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#B392F0;--1:#B392F0\">read</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">();</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">27</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#F97583;--1:#F97583\">for</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> i</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;i</span><span style=\"--0:#F97583;--1:#F97583\">&#x3C;</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">n;i</span><span style=\"--0:#F97583;--1:#F97583\">++</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">) a[i]</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#B392F0;--1:#B392F0\">read</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">();</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">28</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">    </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">f[</span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">]</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">29</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#F97583;--1:#F97583\">for</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> i</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;i</span><span style=\"--0:#F97583;--1:#F97583\">&#x3C;</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">n;i</span><span style=\"--0:#F97583;--1:#F97583\">++</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">){</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">30</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#F97583;--1:#F97583\">if</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(a[i]</span><span style=\"--0:#F97583;--1:#F97583\">==</span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">) f[i]</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">f[i</span><span style=\"--0:#F97583;--1:#F97583\">-</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">]</span><span style=\"--0:#F97583;--1:#F97583\">*</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">i</span><span style=\"--0:#F97583;--1:#F97583\">%</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">mod;</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">31</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#F97583;--1:#F97583\">else</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> f[i]</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">f[i</span><span style=\"--0:#F97583;--1:#F97583\">-</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">]</span><span style=\"--0:#F97583;--1:#F97583\">*</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(i</span><span style=\"--0:#F97583;--1:#F97583\">-</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">)</span><span style=\"--0:#F97583;--1:#F97583\">%</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">mod;</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">32</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">    </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">}</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">33</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">    </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">ans[</span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">]</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">34</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#F97583;--1:#F97583\">for</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> i</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;i</span><span style=\"--0:#F97583;--1:#F97583\">&#x3C;</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">n;i</span><span style=\"--0:#F97583;--1:#F97583\">++</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">){</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">35</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">        </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">ans[i]</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(ans[i</span><span style=\"--0:#F97583;--1:#F97583\">-</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">]</span><span style=\"--0:#F97583;--1:#F97583\">*</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">i</span><span style=\"--0:#F97583;--1:#F97583\">%</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">mod</span><span style=\"--0:#F97583;--1:#F97583\">+</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(a[i]</span><span style=\"--0:#F97583;--1:#F97583\">==</span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">)</span><span style=\"--0:#F97583;--1:#F97583\">*</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">f[i</span><span style=\"--0:#F97583;--1:#F97583\">-</span><span style=\"--0:#79B8FF;--1:#79B8FF\">1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">])</span><span style=\"--0:#F97583;--1:#F97583\">%</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">mod;</span></div></div><div class=\"ec-line\" style=\"--ecIndent:8ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">36</div></div><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#B392F0;--1:#B392F0\">print</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(ans[i],</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">' '</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">);</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">37</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">    </span></span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">}</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">38</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#B392F0;--1:#B392F0\">puts</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">\"\"</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">);</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">39</div></div><div class=\"code\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">}</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">40</div></div><div class=\"code\"><span style=\"--0:#F97583;--1:#F97583\">signed</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#B392F0;--1:#B392F0\">main</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(){</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">41</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#F97583;--1:#F97583\">int</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> T</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#B392F0;--1:#B392F0\">read</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">();</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">42</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#F97583;--1:#F97583\">while</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">(T</span><span style=\"--0:#F97583;--1:#F97583\">--</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">) </span><span style=\"--0:#B392F0;--1:#B392F0\">solve</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">();</span></div></div><div class=\"ec-line\" style=\"--ecIndent:4ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">43</div></div><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#F97583;--1:#F97583\">return</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#79B8FF;--1:#79B8FF\">0</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">;</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">44</div></div><div class=\"code\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">}</span></div></div></code><button class=\"copy-btn\" aria-label=\"Copy code\"><div class=\"copy-btn-icon\"><svg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon copy-icon\"><path d=\"M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z\"></path></svg><svg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon success-icon\"><path d=\"m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z\"></path></svg></div></button></pre></figure></div></section></section><section><h2 id=\"括号序列问题\">括号序列问题<a class=\"anchor\" href=\"#括号序列问题\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h2><p>解决这类问题，考虑几个对括号序列经典的刻画。</p><ul>\n<li>将左括号看成 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>，右括号看成 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>−</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">-1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">−</span><span class=\"mord\">1</span></span></span></span>，一个括号序列合法当且仅当前缀和 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>≤</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">\\le 0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7719em;vertical-align:-0.136em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span> 且总和为 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>。</li>\n<li>将上述过程画在折线统计图。</li>\n<li>递归定义，空串是合法序列，若 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>S</mi><mn>1</mn><mo separator=\"true\">,</mo><mi>S</mi><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">S1,S2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"mord\">2</span></span></span></span> 是合法序列，则 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>S</mi><mn>1</mn><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo><mo stretchy=\"false\">(</mo><mi>S</mi><mn>2</mn><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo><mi>S</mi><mn>1</mn><mi>S</mi><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">(S1),(S2),S1S2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"mord\">1</span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"mord\">2</span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"mord\">1</span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"mord\">2</span></span></span></span> 均为合法序列。</li>\n</ul></section><section><h2 id=\"slope-trick\">Slope Trick<a class=\"anchor\" href=\"#slope-trick\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h2><p>这是管理连续凸函数 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo>:</mo><mi>R</mi><mo>→</mo><mi>R</mi></mrow><annotation encoding=\"application/x-tex\">f:R \\to R</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">:</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span></span></span></span> 的技巧，注意和斜率优化区分开来。\n下面从分段函数入手。\n一个连续的分段函数的每一段斜率范围应为：<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mi>l</mi><mo separator=\"true\">,</mo><mi>l</mi><mo>+</mo><mn>1</mn><mo separator=\"true\">,</mo><mi>l</mi><mo>+</mo><mn>2</mn><mo separator=\"true\">,</mo><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mi>r</mi><mo>−</mo><mn>1</mn><mo separator=\"true\">,</mo><mi>r</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[l,l+1,l+2,...r-1,r]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8389em;vertical-align:-0.1944em;\"></span><span class=\"mord\">2</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">...</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mclose\">]</span></span></span></span>。\n此处要求斜率均为整数。可存在斜率为 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span> 的线段。</p></section></section>";

				const frontmatter = {"title":"DP进阶","published":"2025-06-11T00:00:00.000Z","description":"","image":"","tags":["c++"],"category":"c++","draft":true,"lang":"","minutes":25,"words":4978,"excerpt":"树形 \\text{DP}，即在树上进行的 \\text{DP}。\n由于遍历树固有的递归性质，树形 \\text{DP} 一般都是递归进行的。我们将从一些经典模型和例子开始。"};
				const file = "/workspaces/xuluhui.github.io/src/content/posts/DP_impove.md";
				const url = undefined;

				const Content = createComponent((result, _props, slots) => {
					const { layout, ...content } = frontmatter;
					content.file = file;
					content.url = url;

					return renderTemplate`${maybeRenderHead()}${unescapeHTML(html())}`;
				});

export { Content, Content as default, file, frontmatter, url };
